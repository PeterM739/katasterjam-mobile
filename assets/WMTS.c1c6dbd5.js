import{I as Z,bY as b,R as z,ct as ee,t as te,u as ie,P as ne,L as re,s as se,M as oe,E as ae,v as C,bW as he,bz as ue,c_ as le,bC as X,bO as H,b4 as de,cz as fe}from"./index.d880ed97.js";var U={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */U.read=function(e,t,i,n,r){var s,o,h=r*8-n-1,u=(1<<h)-1,l=u>>1,a=-7,f=i?r-1:0,x=i?-1:1,w=e[t+f];for(f+=x,s=w&(1<<-a)-1,w>>=-a,a+=h;a>0;s=s*256+e[t+f],f+=x,a-=8);for(o=s&(1<<-a)-1,s>>=-a,a+=n;a>0;o=o*256+e[t+f],f+=x,a-=8);if(s===0)s=1-l;else{if(s===u)return o?NaN:(w?-1:1)*(1/0);o=o+Math.pow(2,n),s=s-l}return(w?-1:1)*o*Math.pow(2,s-n)};U.write=function(e,t,i,n,r,s){var o,h,u,l=s*8-r-1,a=(1<<l)-1,f=a>>1,x=r===23?Math.pow(2,-24)-Math.pow(2,-77):0,w=n?0:s-1,g=n?1:-1,_=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(h=isNaN(t)?1:0,o=a):(o=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-o))<1&&(o--,u*=2),o+f>=1?t+=x/u:t+=x*Math.pow(2,1-f),t*u>=2&&(o++,u/=2),o+f>=a?(h=0,o=a):o+f>=1?(h=(t*u-1)*Math.pow(2,r),o=o+f):(h=t*Math.pow(2,f-1)*Math.pow(2,r),o=0));r>=8;e[i+w]=h&255,w+=g,h/=256,r-=8);for(o=o<<r|h,l+=r;l>0;e[i+w]=o&255,w+=g,o/=256,l-=8);e[i+w-g]|=_*128};var ce=c,G=U;function c(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}c.Varint=0;c.Fixed64=1;c.Bytes=2;c.Fixed32=5;var W=(1<<16)*(1<<16),K=1/W,xe=12,$=typeof TextDecoder=="undefined"?null:new TextDecoder("utf8");c.prototype={destroy:function(){this.buf=null},readFields:function(e,t,i){for(i=i||this.length;this.pos<i;){var n=this.readVarint(),r=n>>3,s=this.pos;this.type=n&7,e(r,t,this),this.pos===s&&this.skip(n)}return t},readMessage:function(e,t){return this.readFields(e,t,this.readVarint()+this.pos)},readFixed32:function(){var e=N(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=A(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=N(this.buf,this.pos)+N(this.buf,this.pos+4)*W;return this.pos+=8,e},readSFixed64:function(){var e=N(this.buf,this.pos)+A(this.buf,this.pos+4)*W;return this.pos+=8,e},readFloat:function(){var e=G.read(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:function(){var e=G.read(this.buf,this.pos,!0,52,8);return this.pos+=8,e},readVarint:function(e){var t=this.buf,i,n;return n=t[this.pos++],i=n&127,n<128||(n=t[this.pos++],i|=(n&127)<<7,n<128)||(n=t[this.pos++],i|=(n&127)<<14,n<128)||(n=t[this.pos++],i|=(n&127)<<21,n<128)?i:(n=t[this.pos],i|=(n&15)<<28,we(i,e,this))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return e%2===1?(e+1)/-2:e/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var e=this.readVarint()+this.pos,t=this.pos;return this.pos=e,e-t>=xe&&$?Ce(this.buf,t,e):Be(this.buf,t,e)},readBytes:function(){var e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);return this.pos=e,t},readPackedVarint:function(e,t){if(this.type!==c.Bytes)return e.push(this.readVarint(t));var i=V(this);for(e=e||[];this.pos<i;)e.push(this.readVarint(t));return e},readPackedSVarint:function(e){if(this.type!==c.Bytes)return e.push(this.readSVarint());var t=V(this);for(e=e||[];this.pos<t;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){if(this.type!==c.Bytes)return e.push(this.readBoolean());var t=V(this);for(e=e||[];this.pos<t;)e.push(this.readBoolean());return e},readPackedFloat:function(e){if(this.type!==c.Bytes)return e.push(this.readFloat());var t=V(this);for(e=e||[];this.pos<t;)e.push(this.readFloat());return e},readPackedDouble:function(e){if(this.type!==c.Bytes)return e.push(this.readDouble());var t=V(this);for(e=e||[];this.pos<t;)e.push(this.readDouble());return e},readPackedFixed32:function(e){if(this.type!==c.Bytes)return e.push(this.readFixed32());var t=V(this);for(e=e||[];this.pos<t;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){if(this.type!==c.Bytes)return e.push(this.readSFixed32());var t=V(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){if(this.type!==c.Bytes)return e.push(this.readFixed64());var t=V(this);for(e=e||[];this.pos<t;)e.push(this.readFixed64());return e},readPackedSFixed64:function(e){if(this.type!==c.Bytes)return e.push(this.readSFixed64());var t=V(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed64());return e},skip:function(e){var t=e&7;if(t===c.Varint)for(;this.buf[this.pos++]>127;);else if(t===c.Bytes)this.pos=this.readVarint()+this.pos;else if(t===c.Fixed32)this.pos+=4;else if(t===c.Fixed64)this.pos+=8;else throw new Error("Unimplemented type: "+t)},writeTag:function(e,t){this.writeVarint(e<<3|t)},realloc:function(e){for(var t=this.length||16;t<this.pos+e;)t*=2;if(t!==this.length){var i=new Uint8Array(t);i.set(this.buf),this.buf=i,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),k(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),k(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),k(this.buf,e&-1,this.pos),k(this.buf,Math.floor(e*K),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),k(this.buf,e&-1,this.pos),k(this.buf,Math.floor(e*K),this.pos+4),this.pos+=8},writeVarint:function(e){if(e=+e||0,e>268435455||e<0){Fe(e,this);return}this.realloc(4),this.buf[this.pos++]=e&127|(e>127?128:0),!(e<=127)&&(this.buf[this.pos++]=(e>>>=7)&127|(e>127?128:0),!(e<=127)&&(this.buf[this.pos++]=(e>>>=7)&127|(e>127?128:0),!(e<=127)&&(this.buf[this.pos++]=e>>>7&127)))},writeSVarint:function(e){this.writeVarint(e<0?-e*2-1:e*2)},writeBoolean:function(e){this.writeVarint(Boolean(e))},writeString:function(e){e=String(e),this.realloc(e.length*4),this.pos++;var t=this.pos;this.pos=Ee(this.buf,e,this.pos);var i=this.pos-t;i>=128&&Y(t,i,this),this.pos=t-1,this.writeVarint(i),this.pos+=i},writeFloat:function(e){this.realloc(4),G.write(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:function(e){this.realloc(8),G.write(this.buf,e,this.pos,!0,52,8),this.pos+=8},writeBytes:function(e){var t=e.length;this.writeVarint(t),this.realloc(t);for(var i=0;i<t;i++)this.buf[this.pos++]=e[i]},writeRawMessage:function(e,t){this.pos++;var i=this.pos;e(t,this);var n=this.pos-i;n>=128&&Y(i,n,this),this.pos=i-1,this.writeVarint(n),this.pos+=n},writeMessage:function(e,t,i){this.writeTag(e,c.Bytes),this.writeRawMessage(t,i)},writePackedVarint:function(e,t){t.length&&this.writeMessage(e,ye,t)},writePackedSVarint:function(e,t){t.length&&this.writeMessage(e,Se,t)},writePackedBoolean:function(e,t){t.length&&this.writeMessage(e,Te,t)},writePackedFloat:function(e,t){t.length&&this.writeMessage(e,me,t)},writePackedDouble:function(e,t){t.length&&this.writeMessage(e,Me,t)},writePackedFixed32:function(e,t){t.length&&this.writeMessage(e,Pe,t)},writePackedSFixed32:function(e,t){t.length&&this.writeMessage(e,Ve,t)},writePackedFixed64:function(e,t){t.length&&this.writeMessage(e,ve,t)},writePackedSFixed64:function(e,t){t.length&&this.writeMessage(e,_e,t)},writeBytesField:function(e,t){this.writeTag(e,c.Bytes),this.writeBytes(t)},writeFixed32Field:function(e,t){this.writeTag(e,c.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(e,t){this.writeTag(e,c.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(e,t){this.writeTag(e,c.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(e,t){this.writeTag(e,c.Fixed64),this.writeSFixed64(t)},writeVarintField:function(e,t){this.writeTag(e,c.Varint),this.writeVarint(t)},writeSVarintField:function(e,t){this.writeTag(e,c.Varint),this.writeSVarint(t)},writeStringField:function(e,t){this.writeTag(e,c.Bytes),this.writeString(t)},writeFloatField:function(e,t){this.writeTag(e,c.Fixed32),this.writeFloat(t)},writeDoubleField:function(e,t){this.writeTag(e,c.Fixed64),this.writeDouble(t)},writeBooleanField:function(e,t){this.writeVarintField(e,Boolean(t))}};function we(e,t,i){var n=i.buf,r,s;if(s=n[i.pos++],r=(s&112)>>4,s<128||(s=n[i.pos++],r|=(s&127)<<3,s<128)||(s=n[i.pos++],r|=(s&127)<<10,s<128)||(s=n[i.pos++],r|=(s&127)<<17,s<128)||(s=n[i.pos++],r|=(s&127)<<24,s<128)||(s=n[i.pos++],r|=(s&1)<<31,s<128))return D(e,r,t);throw new Error("Expected varint not more than 10 bytes")}function V(e){return e.type===c.Bytes?e.readVarint()+e.pos:e.pos+1}function D(e,t,i){return i?t*4294967296+(e>>>0):(t>>>0)*4294967296+(e>>>0)}function Fe(e,t){var i,n;if(e>=0?(i=e%4294967296|0,n=e/4294967296|0):(i=~(-e%4294967296),n=~(-e/4294967296),i^4294967295?i=i+1|0:(i=0,n=n+1|0)),e>=18446744073709552e3||e<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");t.realloc(10),pe(i,n,t),ge(n,t)}function pe(e,t,i){i.buf[i.pos++]=e&127|128,e>>>=7,i.buf[i.pos++]=e&127|128,e>>>=7,i.buf[i.pos++]=e&127|128,e>>>=7,i.buf[i.pos++]=e&127|128,e>>>=7,i.buf[i.pos]=e&127}function ge(e,t){var i=(e&7)<<4;t.buf[t.pos++]|=i|((e>>>=3)?128:0),e&&(t.buf[t.pos++]=e&127|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=e&127|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=e&127|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=e&127|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=e&127)))))}function Y(e,t,i){var n=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(Math.LN2*7));i.realloc(n);for(var r=i.pos-1;r>=e;r--)i.buf[r+n]=i.buf[r]}function ye(e,t){for(var i=0;i<e.length;i++)t.writeVarint(e[i])}function Se(e,t){for(var i=0;i<e.length;i++)t.writeSVarint(e[i])}function me(e,t){for(var i=0;i<e.length;i++)t.writeFloat(e[i])}function Me(e,t){for(var i=0;i<e.length;i++)t.writeDouble(e[i])}function Te(e,t){for(var i=0;i<e.length;i++)t.writeBoolean(e[i])}function Pe(e,t){for(var i=0;i<e.length;i++)t.writeFixed32(e[i])}function Ve(e,t){for(var i=0;i<e.length;i++)t.writeSFixed32(e[i])}function ve(e,t){for(var i=0;i<e.length;i++)t.writeFixed64(e[i])}function _e(e,t){for(var i=0;i<e.length;i++)t.writeSFixed64(e[i])}function N(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+e[t+3]*16777216}function k(e,t,i){e[i]=t,e[i+1]=t>>>8,e[i+2]=t>>>16,e[i+3]=t>>>24}function A(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}function Be(e,t,i){for(var n="",r=t;r<i;){var s=e[r],o=null,h=s>239?4:s>223?3:s>191?2:1;if(r+h>i)break;var u,l,a;h===1?s<128&&(o=s):h===2?(u=e[r+1],(u&192)===128&&(o=(s&31)<<6|u&63,o<=127&&(o=null))):h===3?(u=e[r+1],l=e[r+2],(u&192)===128&&(l&192)===128&&(o=(s&15)<<12|(u&63)<<6|l&63,(o<=2047||o>=55296&&o<=57343)&&(o=null))):h===4&&(u=e[r+1],l=e[r+2],a=e[r+3],(u&192)===128&&(l&192)===128&&(a&192)===128&&(o=(s&15)<<18|(u&63)<<12|(l&63)<<6|a&63,(o<=65535||o>=1114112)&&(o=null))),o===null?(o=65533,h=1):o>65535&&(o-=65536,n+=String.fromCharCode(o>>>10&1023|55296),o=56320|o&1023),n+=String.fromCharCode(o),r+=h}return n}function Ce(e,t,i){return $.decode(e.subarray(t,i))}function Ee(e,t,i){for(var n=0,r,s;n<t.length;n++){if(r=t.charCodeAt(n),r>55295&&r<57344)if(s)if(r<56320){e[i++]=239,e[i++]=191,e[i++]=189,s=r;continue}else r=s-55296<<10|r-56320|65536,s=null;else{r>56319||n+1===t.length?(e[i++]=239,e[i++]=191,e[i++]=189):s=r;continue}else s&&(e[i++]=239,e[i++]=191,e[i++]=189,s=null);r<128?e[i++]=r:(r<2048?e[i++]=r>>6|192:(r<65536?e[i++]=r>>12|224:(e[i++]=r>>18|240,e[i++]=r>>12&63|128),e[i++]=r>>6&63|128),e[i++]=r&63|128)}return i}class De extends Z{constructor(t){super(),t=t||{},this.dataProjection=new b({code:"",units:"tile-pixels"}),this.featureClass_=t.featureClass?t.featureClass:z,this.geometryName_=t.geometryName,this.layerName_=t.layerName?t.layerName:"layer",this.layers_=t.layers?t.layers:null,this.idProperty_=t.idProperty,this.supportedMediaTypes=["application/vnd.mapbox-vector-tile","application/x-protobuf"]}readRawGeometry_(t,i,n,r){t.pos=i.geometry;const s=t.readVarint()+t.pos;let o=1,h=0,u=0,l=0,a=0,f=0;for(;t.pos<s;){if(!h){const x=t.readVarint();o=x&7,h=x>>3}if(h--,o===1||o===2)u+=t.readSVarint(),l+=t.readSVarint(),o===1&&a>f&&(r.push(a),f=a),n.push(u,l),a+=2;else if(o===7)a>f&&(n.push(n[f],n[f+1]),a+=2);else throw new Error("Invalid command found in the PBF")}a>f&&(r.push(a),f=a)}createFeature_(t,i,n){const r=i.type;if(r===0)return null;let s;const o=i.properties;let h;this.idProperty_?(h=o[this.idProperty_],delete o[this.idProperty_]):h=i.id,o[this.layerName_]=i.layer.name;const u=[],l=[];this.readRawGeometry_(t,i,u,l);const a=Ge(r,l.length);if(this.featureClass_===z)s=new this.featureClass_(a,u,l,2,o,h),s.transform(n.dataProjection);else{let f;if(a=="Polygon"){const g=ee(u,l);f=g.length>1?new te(u,"XY",g):new ie(u,"XY",l)}else f=a==="Point"?new ne(u,"XY"):a==="LineString"?new re(u,"XY"):a==="MultiPoint"?new se(u,"XY"):a==="MultiLineString"?new oe(u,"XY",l):null;const x=this.featureClass_;s=new x,this.geometryName_&&s.setGeometryName(this.geometryName_);const w=ae(f,!1,n);s.setGeometry(w),h!==void 0&&s.setId(h),s.setProperties(o,!0)}return s}getType(){return"arraybuffer"}readFeatures(t,i){const n=this.layers_;i=this.adaptOptions(i);const r=C(i.dataProjection);r.setWorldExtent(i.extent),i.dataProjection=r;const s=new ce(t),o=s.readFields(ke,{}),h=[];for(const u in o){if(n&&!n.includes(u))continue;const l=o[u],a=l?[0,0,l.extent,l.extent]:null;r.setExtent(a);for(let f=0,x=l.length;f<x;++f){const w=Re(s,l,f),g=this.createFeature_(s,w,i);g!==null&&h.push(g)}}return h}readProjection(t){return this.dataProjection}setLayers(t){this.layers_=t}}function ke(e,t,i){if(e===3){const n={keys:[],values:[],features:[]},r=i.readVarint()+i.pos;i.readFields(Ie,n,r),n.length=n.features.length,n.length&&(t[n.name]=n)}}function Ie(e,t,i){if(e===15)t.version=i.readVarint();else if(e===1)t.name=i.readString();else if(e===5)t.extent=i.readVarint();else if(e===2)t.features.push(i.pos);else if(e===3)t.keys.push(i.readString());else if(e===4){let n=null;const r=i.readVarint()+i.pos;for(;i.pos<r;)e=i.readVarint()>>3,n=e===1?i.readString():e===2?i.readFloat():e===3?i.readDouble():e===4?i.readVarint64():e===5?i.readVarint():e===6?i.readSVarint():e===7?i.readBoolean():null;t.values.push(n)}}function je(e,t,i){if(e==1)t.id=i.readVarint();else if(e==2){const n=i.readVarint()+i.pos;for(;i.pos<n;){const r=t.layer.keys[i.readVarint()],s=t.layer.values[i.readVarint()];t.properties[r]=s}}else e==3?t.type=i.readVarint():e==4&&(t.geometry=i.pos)}function Re(e,t,i){e.pos=t.features[i];const n=e.readVarint()+e.pos,r={layer:t,type:0,properties:{}};return e.readFields(je,r,n),r}function Ge(e,t){let i;return e===1?i=t===1?"Point":"MultiPoint":e===2?i=t===1?"LineString":"MultiLineString":e===3&&(i="Polygon"),i}var We=De;class J extends he{constructor(t){super({extent:t.extent,origin:t.origin,origins:t.origins,resolutions:t.resolutions,tileSize:t.tileSize,tileSizes:t.tileSizes,sizes:t.sizes}),this.matrixIds_=t.matrixIds}getMatrixId(t){return this.matrixIds_[t]}getMatrixIds(){return this.matrixIds_}}var Ue=J;function Ne(e,t,i){const n=[],r=[],s=[],o=[],h=[];i=i!==void 0?i:[];const u="SupportedCRS",l="TileMatrix",a="Identifier",f="ScaleDenominator",x="TopLeftCorner",w="TileWidth",g="TileHeight",_=e[u],I=C(_),S=I.getMetersPerUnit(),M=I.getAxisOrientation().substr(0,2)=="ne";return e[l].sort(function(F,m){return m[f]-F[f]}),e[l].forEach(function(F){let m;if(i.length>0?m=i.find(function(B){return F[a]==B[l]?!0:F[a].includes(":")?!1:e[a]+":"+F[a]===B[l]}):m=!0,m){r.push(F[a]);const B=F[f]*28e-5/S,E=F[w],y=F[g];M?s.push([F[x][1],F[x][0]]):s.push(F[x]),n.push(B),o.push(E==y?E:[E,y]),h.push([F.MatrixWidth,F.MatrixHeight])}}),new J({extent:t,origins:s,resolutions:n,matrixIds:r,tileSizes:o,sizes:h})}function q(e,t){const i=[];Object.keys(t).forEach(function(r){t[r]!==null&&t[r]!==void 0&&i.push(r+"="+encodeURIComponent(t[r]))});const n=i.join("&");return e=e.replace(/[?&]$/,""),e+=e.includes("?")?"&":"?",e+n}class Le extends ue{constructor(t){const i=t.requestEncoding!==void 0?t.requestEncoding:"KVP",n=t.tileGrid;let r=t.urls;r===void 0&&t.url!==void 0&&(r=le(t.url)),super({attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,interpolate:t.interpolate,projection:t.projection,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileClass:t.tileClass,tileGrid:n,tileLoadFunction:t.tileLoadFunction,tilePixelRatio:t.tilePixelRatio,urls:r,wrapX:t.wrapX!==void 0?t.wrapX:!1,transition:t.transition,zDirection:t.zDirection}),this.version_=t.version!==void 0?t.version:"1.0.0",this.format_=t.format!==void 0?t.format:"image/jpeg",this.dimensions_=t.dimensions!==void 0?t.dimensions:{},this.layer_=t.layer,this.matrixSet_=t.matrixSet,this.style_=t.style,this.requestEncoding_=i,this.setKey(this.getKeyForDimensions_()),r&&r.length>0&&(this.tileUrlFunction=X(r.map(this.createFromWMTSTemplate.bind(this))))}setUrls(t){this.urls=t;const i=t.join(`
`);this.setTileUrlFunction(X(t.map(this.createFromWMTSTemplate.bind(this))),i)}getDimensions(){return this.dimensions_}getFormat(){return this.format_}getLayer(){return this.layer_}getMatrixSet(){return this.matrixSet_}getRequestEncoding(){return this.requestEncoding_}getStyle(){return this.style_}getVersion(){return this.version_}getKeyForDimensions_(){const t=this.urls?this.urls.slice(0):[];for(const i in this.dimensions_)t.push(i+"-"+this.dimensions_[i]);return t.join("/")}updateDimensions(t){Object.assign(this.dimensions_,t),this.setKey(this.getKeyForDimensions_())}createFromWMTSTemplate(t){const i=this.requestEncoding_,n={layer:this.layer_,style:this.style_,tilematrixset:this.matrixSet_};i=="KVP"&&Object.assign(n,{Service:"WMTS",Request:"GetTile",Version:this.version_,Format:this.format_}),t=i=="KVP"?q(t,n):t.replace(/\{(\w+?)\}/g,function(o,h){return h.toLowerCase()in n?n[h.toLowerCase()]:o});const r=this.tileGrid,s=this.dimensions_;return function(o,h,u){if(!o)return;const l={TileMatrix:r.getMatrixId(o[0]),TileCol:o[1],TileRow:o[2]};Object.assign(l,s);let a=t;return i=="KVP"?a=q(a,l):a=a.replace(/\{(\w+?)\}/g,function(f,x){return l[x]}),a}}}var ze=Le;function Xe(e,t){const i=e.Contents.Layer,n=i==null?void 0:i.find(function(d){return d.Identifier==t.layer});if(!n)return null;const r=e.Contents.TileMatrixSet;let s;n.TileMatrixSetLink.length>1?"projection"in t?s=n.TileMatrixSetLink.findIndex(function(d){const v=r.find(function(O){return O.Identifier==d.TileMatrixSet}).SupportedCRS,R=C(v),P=C(t.projection);return R&&P?H(R,P):v==t.projection}):s=n.TileMatrixSetLink.findIndex(function(d){return d.TileMatrixSet==t.matrixSet}):s=0,s<0&&(s=0);const o=n.TileMatrixSetLink[s].TileMatrixSet,h=n.TileMatrixSetLink[s].TileMatrixSetLimits;let u=n.Format[0];"format"in t&&(u=t.format),s=n.Style.findIndex(function(d){return"style"in t?d.Title==t.style:d.isDefault}),s<0&&(s=0);const l=n.Style[s].Identifier,a={};"Dimension"in n&&n.Dimension.forEach(function(d,p,v){const R=d.Identifier;let P=d.Default;P===void 0&&(P=d.Value[0]),a[R]=P});const x=e.Contents.TileMatrixSet.find(function(d){return d.Identifier==o});let w;const g=x.SupportedCRS;if(g&&(w=C(g)),"projection"in t){const d=C(t.projection);d&&(!w||H(d,w))&&(w=d)}let _=!1;const I=w.getAxisOrientation().substr(0,2)=="ne";let S=x.TileMatrix[0],M={MinTileCol:0,MinTileRow:0,MaxTileCol:S.MatrixWidth-1,MaxTileRow:S.MatrixHeight-1};if(h){M=h[h.length-1];const d=x.TileMatrix.find(p=>p.Identifier===M.TileMatrix||x.Identifier+":"+p.Identifier===M.TileMatrix);d&&(S=d)}const F=S.ScaleDenominator*28e-5/w.getMetersPerUnit(),m=I?[S.TopLeftCorner[1],S.TopLeftCorner[0]]:S.TopLeftCorner,B=S.TileWidth*F,E=S.TileHeight*F;let y=x.BoundingBox;y&&I&&(y=[y[1],y[0],y[3],y[2]]);let L=[m[0]+B*M.MinTileCol,m[1]-E*(1+M.MaxTileRow),m[0]+B*(1+M.MaxTileCol),m[1]-E*M.MinTileRow];if(y!==void 0&&!de(y,L)){const d=n.WGS84BoundingBox,p=C("EPSG:4326").getExtent();if(L=y,d)_=d[0]===p[0]&&d[2]===p[2];else{const v=fe(y,x.SupportedCRS,"EPSG:4326");_=v[0]-1e-10<=p[0]&&v[2]+1e-10>=p[2]}}const Q=Ne(x,L,h),j=[];let T=t.requestEncoding;if(T=T!==void 0?T:"","OperationsMetadata"in e&&"GetTile"in e.OperationsMetadata){const d=e.OperationsMetadata.GetTile.DCP.HTTP.Get;for(let p=0,v=d.length;p<v;++p)if(d[p].Constraint){const P=d[p].Constraint.find(function(O){return O.name=="GetEncoding"}).AllowedValues.Value;if(T===""&&(T=P[0]),T==="KVP")P.includes("KVP")&&j.push(d[p].href);else break}else d[p].href&&(T="KVP",j.push(d[p].href))}return j.length===0&&(T="REST",n.ResourceURL.forEach(function(d){d.resourceType==="tile"&&(u=d.format,j.push(d.template))})),{urls:j,layer:t.layer,matrixSet:o,format:u,projection:w,requestEncoding:T,tileGrid:Q,style:l,dimensions:a,wrapX:_,crossOrigin:t.crossOrigin}}export{We as M,Ue as T,ze as W,q as a,Xe as o};
