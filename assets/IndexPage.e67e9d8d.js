import{Q as Wl}from"./QResizeObserver.b8f563d0.js";import{Q as Xt,a as kt}from"./QFab.5908d0d1.js";import{i as Ql,dk as Ct,dl as Ul,c as C,g as Ne,dj as vl,h as F,c$ as We,d2 as pe,cM as B,d9 as oe,da as h,cO as jl,e5 as Qe,r as k,dR as D,d as r,L as Yt,e6 as Zt,cN as ve,de as ht,df as Te,dc as ye,dd as z,dS as $e,e7 as ml,di as me,e8 as lt,F as ot,d5 as gt,d7 as tt,aa as Kl,y as Je,P as dt,e9 as Xl,cV as Be,d6 as hl,bF as Yl,ea as gl,dY as Zl,eb as Gl,ec as Jl,dW as Mt,ed as yl,ee as eo,dO as to,ef as pl,dg as Ft,db as J,eg as Ye,dh as lo,eh as At,ei as Sl,ej as bl,ek as wl,dE as _l,dF as oo,dG as kl,dH as no,dP as ao,el as io,dT as ro,dC as we,e1 as et,cR as ge,d$ as Gt,w as ie,o as uo,dm as nt,e4 as so,ds as Tt,em as Jt,dZ as co,dw as fo,dJ as vo,en as mo,dK as ho,eo as go,dL as yo,ep as po,dM as So,eq as bo,er as wo,es as el,et as _o,e3 as ko,eu as Co,dq as xo,ev as Vo,ew as Lo,dD as qo,ex as Fo,dr as To,ey as Do,ez as zo,dz as Mo,dA as Ao,eA as Io,eB as Eo,eC as tl,eD as Ze,eE as Po,eF as Oo,eG as Ro,e2 as Re,eH as $o,dx as Bo,d8 as Ho,eI as No,cJ as Wo}from"./index.d880ed97.js";import{Q as Qo,a as Cl,b as Uo,c as jo}from"./QPage.afe2ab63.js";import{C as Ko}from"./CartoLayers.620906c1.js";import{u as xl}from"./use-quasar.fff60b60.js";import{Q as ee,a as Fe,c as ae,d as Xo,n as ll}from"./format.7f0b6061.js";import"./WMTS.c1c6dbd5.js";const Yo={position:{type:String,default:"bottom-right",validator:e=>["top-right","top-left","bottom-right","bottom-left","top","right","bottom","left"].includes(e)},offset:{type:Array,validator:e=>e.length===2},expand:Boolean};function Zo(){const{props:e,proxy:{$q:t}}=Ne(),n=Ql(Ul,Ct);if(n===Ct)return console.error("QPageSticky needs to be child of QLayout"),Ct;const o=C(()=>{const v=e.position;return{top:v.indexOf("top")!==-1,right:v.indexOf("right")!==-1,bottom:v.indexOf("bottom")!==-1,left:v.indexOf("left")!==-1,vertical:v==="top"||v==="bottom",horizontal:v==="left"||v==="right"}}),s=C(()=>n.header.offset),a=C(()=>n.right.offset),i=C(()=>n.footer.offset),d=C(()=>n.left.offset),m=C(()=>{let v=0,w=0;const f=o.value,_=t.lang.rtl===!0?-1:1;f.top===!0&&s.value!==0?w=`${s.value}px`:f.bottom===!0&&i.value!==0&&(w=`${-i.value}px`),f.left===!0&&d.value!==0?v=`${_*d.value}px`:f.right===!0&&a.value!==0&&(v=`${-_*a.value}px`);const I={transform:`translate(${v}, ${w})`};return e.offset&&(I.margin=`${e.offset[1]}px ${e.offset[0]}px`),f.vertical===!0?(d.value!==0&&(I[t.lang.rtl===!0?"right":"left"]=`${d.value}px`),a.value!==0&&(I[t.lang.rtl===!0?"left":"right"]=`${a.value}px`)):f.horizontal===!0&&(s.value!==0&&(I.top=`${s.value}px`),i.value!==0&&(I.bottom=`${i.value}px`)),I}),p=C(()=>`q-page-sticky row flex-center fixed-${e.position} q-page-sticky--${e.expand===!0?"expand":"shrink"}`);function c(v){const w=vl(v.default);return F("div",{class:p.value,style:m.value},e.expand===!0?w:[F("div",w)])}return{$layout:n,getStickyContent:c}}var xt=We({name:"QPageSticky",props:Yo,setup(e,{slots:t}){const{getStickyContent:n}=Zo();return()=>n(t)}});const Go={name:"PageFullScreen",methods:{tweak(){return{height:this.$q.screen.height-50+"px"}},myTweak(e){e||(e=0);const t=this.$q.platform.is.cordova?`calc(100vh - ${e}px)`:window.innerHeight-e+"px";return this.$store.state.windowSize=t,{minHeight:t}}}};function Jo(e,t,n,o,s,a){return B(),oe(Qo,{"style-fn":a.tweak,class:"scroll-y fhpadd"},{default:h(()=>[jl(e.$slots,"default")]),_:3},8,["style-fn"])}var en=pe(Go,[["render",Jo]]);const tn={setup(){const e=Qe(),t=k(5),n=k("red");return{store:e,strokeWidth:t,strokeColor:n}},computed:{myTrack(){return this.store.getMyTrack}}};function ln(e,t,n,o,s,a){const i=D("ol-geom-line-string"),d=D("ol-style-stroke"),m=D("ol-style"),p=D("ol-feature"),c=D("ol-source-vector"),v=D("ol-vector-layer");return B(),oe(v,null,{default:h(()=>[r(c,null,{default:h(()=>[r(p,null,{default:h(()=>[r(i,{coordinates:a.myTrack},null,8,["coordinates"]),r(m,null,{default:h(()=>[r(d,{color:o.strokeColor,width:o.strokeWidth},null,8,["color","width"])]),_:1})]),_:1})]),_:1})]),_:1})}var on=pe(tn,[["render",ln]]);const nn=F("div",{class:"q-space"});var Dt=We({name:"QSpace",setup(){return()=>nn}});const an={setup(){const e=k(!0),t=k("top"),n=Qe(),o=k(3),s=k("green");return{dialog:e,position:t,store:n,strokeWidth:o,strokeColor:s}},data(){return{currentCenter:this.center,currentZoom:this.zoom,currentResolution:this.resolution,fixedCenter:!1,name:this.$route.query.name}},computed:{bearing(){return(([n,o],[s,a])=>{const i=s-n,d=a-o;return(Math.atan2(i,d)*180/Math.PI+360)%360})(this.store.getNavigateTo[1],this.store.getNavigateTo[0])-this.store.getRotation},navigateTo(){return this.store.getNavigateTo},navigationInProgress(){return this.store.getNavigateTo.length>0},distance(){const e=new Yt(this.store.getNavigateTo),t=Zt(e);return t>1e3?(t/1e3).toFixed(2):parseInt(t)},distanceUnit(){const e=new Yt(this.store.getNavigateTo);return Zt(e)>1e3?"km":"m"}},methods:{stopNavigation(){this.store.stopNavigation()}}},rn={class:"text-weight-bold"},un={class:"text-grey"};function sn(e,t,n,o,s,a){const i=D("ol-geom-line-string"),d=D("ol-style-stroke"),m=D("ol-style"),p=D("ol-feature"),c=D("ol-source-vector"),v=D("ol-vector-layer");return B(),ve(ot,null,[r(lt,{modelValue:a.navigationInProgress,"onUpdate:modelValue":t[0]||(t[0]=w=>a.navigationInProgress=w),position:o.position,seamless:"",class:"q-dialog__top50"},{default:h(()=>[r(ht,{style:{width:"350px"}},{default:h(()=>[r(Te,{class:"row items-center no-wrap"},{default:h(()=>[ye("div",null,[ye("div",rn,z(e.$t("goTo"))+": "+z(s.name),1),ye("div",un,z(e.$t("distance"))+": "+z(a.distance)+" "+z(a.distanceUnit),1)]),r(Dt),r($e,{name:"navigation",style:ml({rotate:a.bearing+"deg"}),size:"lg"},null,8,["style"]),r(me,{flat:"",round:"",icon:"stop",onClick:a.stopNavigation},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue","position"]),r(v,null,{default:h(()=>[r(c,null,{default:h(()=>[r(p,null,{default:h(()=>[r(i,{coordinates:a.navigateTo},null,8,["coordinates"]),r(m,null,{default:h(()=>[r(d,{color:o.strokeColor,width:o.strokeWidth},null,8,["color","width"])]),_:1})]),_:1})]),_:1})]),_:1})],64)}var cn=pe(an,[["render",sn]]);const dn={props:["view"],emits:["centerChanged"],components:{TrackingLayer:on,NavigationLayer:cn},setup(){const e=Qe(),t=gt(),n=k([]),o=k([]),s=k([]),{myLocation:a}=tt(e),{clickLocation:i}=tt(t);return{store:e,myLocationCoordinates:n,myLocationFeatures:o,myLocation:a,clickFeature:s,clickLocation:i}},computed:{rotation(){return this.store.getRotation}},watch:{myLocation(e,t){const n=Kl([e.longitude,e.latitude],this.store.getMyLocationAccuracy);this.myLocationFeatures=[new Je(n.transform("EPSG:4326",this.store.getProjection)),new Je(new dt(this.store.getMyLocationCoordinates))],this.myLocationCoordinates=e.coordinates,this.$emit("centerChanged",this.store.getMyLocationCoordinates)},clickLocation(e,t){e?this.clickFeature=[new Je(new dt(e))]:this.clickFeature=[]}}};function fn(e,t,n,o,s,a){const i=D("ol-source-vector"),d=D("ol-vector-layer"),m=D("ol-overlay"),p=D("TrackingLayer"),c=D("NavigationLayer");return B(),ve(ot,null,[r(d,null,{default:h(()=>[r(i,{features:o.myLocationFeatures},null,8,["features"])]),_:1}),r(d,null,{default:h(()=>[r(i,{features:o.clickFeature},null,8,["features"])]),_:1}),o.myLocationFeatures.length>0?(B(),oe(m,{key:0,position:o.myLocationCoordinates,positioning:"center-center"},{default:h(v=>[r($e,{name:"navigation",class:Xl(v),style:ml({rotate:a.rotation+"deg"}),size:"lg"},null,8,["class","style"])]),_:1},8,["position"])):Be("",!0),r(p),r(c)],64)}var vn=pe(dn,[["render",fn]]);const mn={setup(){const e=hl(),t=k([]),n=k(new Yl);return e.loadForMap().then(()=>{e.customLocationsForMap.map(o=>t.value.push(o))}),{vectorSource:n,store:e,customLocations:t}}};function hn(e,t,n,o,s,a){const i=D("ol-geom-point"),d=D("ol-style-icon"),m=D("ol-style"),p=D("ol-feature"),c=D("ol-source-vector"),v=D("ol-vector-layer");return B(),oe(v,null,{default:h(()=>[r(c,{ref:"vectorSource"},{default:h(()=>[(B(!0),ve(ot,null,gl(o.customLocations,w=>(B(),oe(p,{key:w.id,properties:{id:w.id,name:w.name,lat:w.lat.toFixed(5),lng:w.lng.toFixed(5),type:"poi"}},{default:h(()=>[r(i,{coordinates:w.latLng},null,8,["coordinates"]),r(m,null,{default:h(()=>[r(d,{src:w.icon,scale:1},null,8,["src"])]),_:2},1024)]),_:2},1032,["properties"]))),128))]),_:1},512)]),_:1})}var gn=pe(mn,[["render",hn]]);function ol(e){if(e===!1)return 0;if(e===!0||e===void 0)return 1;const t=parseInt(e,10);return isNaN(t)?0:t}var yn=Zl({name:"close-popup",beforeMount(e,{value:t}){const n={depth:ol(t),handler(o){n.depth!==0&&setTimeout(()=>{const s=Gl(e);s!==void 0&&Jl(s,o,n.depth)})},handlerKey(o){Mt(o,13)===!0&&n.handler(o)}};e.__qclosepopup=n,e.addEventListener("click",n.handler),e.addEventListener("keyup",n.handlerKey)},updated(e,{value:t,oldValue:n}){t!==n&&(e.__qclosepopup.depth=ol(t))},beforeUnmount(e){const t=e.__qclosepopup;e.removeEventListener("click",t.handler),e.removeEventListener("keyup",t.handlerKey),delete e.__qclosepopup}});const pn={setup(){const e=xl(),t=gt(),n=Qe();t.hideDrawer();const o=k(!1),{showBottomDrawer:s}=tt(t);return{dialog:o,confirmDialog:e.dialog,mapStore:t,locationStore:n,showBottomDrawer:s}},computed:{clickedFeature(){return this.mapStore.getClickedFeature},drawerLoading(){return this.mapStore.getDrawerLoading}},methods:{hideDrawer(){this.mapStore.hideDrawer()},goTo(){const e=`[${this.clickedFeature.id}] ${this.clickedFeature.name}`;this.confirmDialog({title:`${this.$t("confirm")}`,message:`${this.$t(this.clickedFeature.type==="cave"?"navigateToCave":"navigateToCustomLocation")}: ${e}`,cancel:!0,persistent:!0}).onOk(()=>{const t=yl([this.clickedFeature.lng,this.clickedFeature.lat]),n=new Je(new dt(t));this.locationStore.startNavigation(n)})},info(e){this.$router.push({name:this.clickedFeature.type==="cave"?"caves-details":"custom-locations-details",params:{id:e}})},addNewLocation(){this.locationStore.createNew([this.clickedFeature.lng,this.clickedFeature.lat])}},watch:{showBottomDrawer(e,t){this.dialog=e}}},Sn={class:"q-pa-md q-gutter-sm"},bn={key:0,class:"text-weight-bold"},wn={key:1,class:"text-weight-bold"},_n={key:0,class:"text-grey"},kn={class:"text-grey"};function Cn(e,t,n,o,s,a){return B(),ve("div",Sn,[r(lt,{modelValue:o.dialog,"onUpdate:modelValue":t[3]||(t[3]=i=>o.dialog=i),position:"bottom",onHide:a.hideDrawer,seamless:""},{default:h(()=>[r(ht,{style:{width:"350px"}},{default:h(()=>[a.drawerLoading?(B(),oe(Te,{key:0,class:"row justify-center items-center"},{default:h(()=>[r(eo,{color:"primary",size:"3em",thickness:2})]),_:1})):(B(),ve(ot,{key:1},[r(Te,{class:"row items-center q-pb-none"},{default:h(()=>[a.clickedFeature.type!=="click"?(B(),ve("div",bn,"["+z(a.clickedFeature.id)+"] "+z(a.clickedFeature.name),1)):(B(),ve("div",wn,z(e.$t("clickInfo"))+":",1)),r(Dt),to(r(me,{icon:"close",flat:"",round:"",dense:""},null,512),[[yn]])]),_:1}),r(Te,{class:"row items-center no-wrap"},{default:h(()=>[ye("div",null,[a.clickedFeature.type==="cave"?(B(),ve("div",_n,z(e.$t("length"))+": "+z(a.clickedFeature.length)+" m, "+z(e.$t("depth"))+": "+z(a.clickedFeature.depth)+" m",1)):Be("",!0),ye("div",kn,z(e.$t("lat"))+": "+z(a.clickedFeature.lat)+", "+z(e.$t("lng"))+": "+z(a.clickedFeature.lng),1)]),r(Dt),a.clickedFeature.type!=="click"?(B(),oe(me,{key:0,flat:"",round:"",icon:"info",onClick:t[0]||(t[0]=i=>a.info(a.clickedFeature.id))})):Be("",!0),a.clickedFeature.type=="click"?(B(),oe(me,{key:1,flat:"",round:"",icon:"add",onClick:t[1]||(t[1]=i=>a.addNewLocation())})):Be("",!0),r(me,{flat:"",round:"",icon:"assist_walker",onClick:t[2]||(t[2]=i=>a.goTo())})]),_:1})],64))]),_:1})]),_:1},8,["modelValue","onHide"])])}var xn=pe(pn,[["render",Cn]]);const Vn={setup(){const{dialog:e,notify:t}=xl(),n=pl(),o=gt(),{getShowDialog:s,progress:a,allContent:i,currentContent:d}=tt(n),m=k(!1),p=k("");return{notify:t,offlineDataName:p,offlineStore:n,mapStore:o,getShowDialog:s,selectedItems:k([]),confirmDialog:k(!1),confirmDownloadDialog:e,progress:a,allContent:i,currentContent:d,progressLabel:C(()=>(a.value*100).toFixed(2)+"%"),allProgressLabel:C(()=>d.value+"/"+i.value),inProgress:m}},watch:{getShowDialog(e,t){this.confirmDialog=e}},methods:{async onSubmit(){if(this.offlineDataName.length===0){this.notify({message:this.$t("offlineNameMissing"),color:"red"});return}this.confirmDownloadDialog({title:`${this.$t("confirm")}`,message:`${this.$t("confirmDownloadOfArea")}`,cancel:!0,persistent:!0}).onOk(async()=>{this.inProgress=!0;try{await this.offlineStore.transferData([...this.selectedItems,"cavesLayer"],this.mapStore.getExtent,this.offlineDataName)}catch(e){console.log(e)}finally{this.onReset()}})},onReset(){this.inProgress=!1,this.confirmDialog=!1,this.offlineStore.hideDialog()}}},Ln={class:"q-pa-md q-gutter-sm"},qn={class:"text-h6"},Fn={class:"text-grey-6"},Tn={class:"absolute-full flex flex-center"};function Dn(e,t,n,o,s,a){return B(),ve("div",Ln,[r(lt,{modelValue:o.confirmDialog,"onUpdate:modelValue":t[6]||(t[6]=i=>o.confirmDialog=i),noBackdropDismiss:""},{default:h(()=>[r(ht,{style:{width:"300px"},class:"q-px-sm q-pb-md"},{default:h(()=>[r(Cl,{onSubmit:a.onSubmit,onReset:a.onReset,class:"q-gutter-md"},{default:h(()=>[r(Te,null,{default:h(()=>[ye("div",qn,z(e.$t("dataForOffline")),1)]),_:1}),r(Te,null,{default:h(()=>[r(Ft,{disable:o.inProgress,modelValue:o.offlineDataName,"onUpdate:modelValue":t[0]||(t[0]=i=>o.offlineDataName=i),label:e.$t("offlineDataName"),dense:"",rules:[i=>i&&i.length>0||"Please type something"]},null,8,["disable","modelValue","label","rules"])]),_:1}),r(ee,{header:""},{default:h(()=>[J(z(e.$t("mapLayers")),1)]),_:1}),r(Fe,{dense:""},{default:h(()=>[r(ae,{avatar:""},{default:h(()=>[r(Ye,{disable:o.inProgress,modelValue:o.selectedItems,"onUpdate:modelValue":t[1]||(t[1]=i=>o.selectedItems=i),val:"osm",color:"teal"},null,8,["disable","modelValue"])]),_:1}),r(ae,null,{default:h(()=>[r(ee,null,{default:h(()=>[J(z(e.$t("osmMapLayer")),1)]),_:1}),r(ee,{caption:""},{default:h(()=>[J(z(e.$t("osmMapLayerDescription")),1)]),_:1})]),_:1})]),_:1}),r(Fe,{dense:""},{default:h(()=>[r(ae,{avatar:""},{default:h(()=>[r(Ye,{disable:o.inProgress,modelValue:o.selectedItems,"onUpdate:modelValue":t[2]||(t[2]=i=>o.selectedItems=i),val:"lidar",color:"teal"},null,8,["disable","modelValue"])]),_:1}),r(ae,null,{default:h(()=>[r(ee,null,{default:h(()=>[J(z(e.$t("lidarMapLayer")),1)]),_:1}),r(ee,{caption:""},{default:h(()=>[J(z(e.$t("lidarMapLayerDescription")),1)]),_:1})]),_:1})]),_:1}),r(Fe,{dense:""},{default:h(()=>[r(ae,{avatar:"",top:""},{default:h(()=>[r(Ye,{disable:o.inProgress,modelValue:o.selectedItems,"onUpdate:modelValue":t[3]||(t[3]=i=>o.selectedItems=i),val:"ortophoto",color:"teal"},null,8,["disable","modelValue"])]),_:1}),r(ae,null,{default:h(()=>[r(ee,null,{default:h(()=>[J(z(e.$t("orthoMapLayer")),1)]),_:1}),r(ee,{caption:""},{default:h(()=>[J(z(e.$t("orthoMapLayerDescription")),1)]),_:1})]),_:1})]),_:1}),r(ee,{header:""},{default:h(()=>[J(z(e.$t("caves")),1)]),_:1}),r(Fe,{dense:""},{default:h(()=>[r(ae,{avatar:"",top:""},{default:h(()=>[r(Ye,{disable:o.inProgress,modelValue:o.selectedItems,"onUpdate:modelValue":t[4]||(t[4]=i=>o.selectedItems=i),val:"caves",color:"teal"},null,8,["disable","modelValue"])]),_:1}),r(ae,null,{default:h(()=>[r(ee,null,{default:h(()=>[J(z(e.$t("caveData")),1)]),_:1}),r(ee,{caption:""},{default:h(()=>[J(z(e.$t("caveDataDescription")),1)]),_:1})]),_:1})]),_:1}),r(ee,{header:""},{default:h(()=>[J(z(e.$t("customLocations")),1)]),_:1}),r(Fe,{dense:""},{default:h(()=>[r(ae,{avatar:"",top:""},{default:h(()=>[r(Ye,{disable:o.inProgress,modelValue:o.selectedItems,"onUpdate:modelValue":t[5]||(t[5]=i=>o.selectedItems=i),val:"customLocations",color:"teal"},null,8,["disable","modelValue"])]),_:1}),r(ae,null,{default:h(()=>[r(ee,null,{default:h(()=>[J(z(e.$t("customLocationsData")),1)]),_:1}),r(ee,{caption:""},{default:h(()=>[J(z(e.$t("customLocationsDataDescription")),1)]),_:1})]),_:1})]),_:1}),o.inProgress?(B(),oe(Te,{key:0,class:"text-center q-pa-none"},{default:h(()=>[ye("p",Fn,z(e.$t("fetchingData"))+": "+z(o.allProgressLabel),1),r(Uo,{"instant-feedback":!0,size:"50px",value:o.progress,color:"accent",class:"q-mt-sm"},{default:h(()=>[ye("div",Tn,[r(jo,{color:"white","text-color":"accent",label:o.progressLabel},null,8,["label"])])]),_:1},8,["value"])]),_:1})):Be("",!0),r(lo,{align:"center",class:"q-mt-md"},{default:h(()=>[r(me,{disable:o.inProgress,label:e.$t("download"),type:"submit",color:"primary"},null,8,["disable","label"]),r(me,{label:e.$t("cancel"),type:"reset",color:"primary",flat:"",class:"q-ml-sm"},null,8,["label"])]),_:1})]),_:1},8,["onSubmit","onReset"])]),_:1})]),_:1},8,["modelValue"])])}var zn=pe(Vn,[["render",Dn]]),Mn=We({name:"QField",inheritAttrs:!1,props:{...At,tag:{type:String,default:"label"}},emits:Sl,setup(){return bl(wl({requiredForAttr:!1,tagProp:!0}))}});const An={xs:8,sm:10,md:14,lg:20,xl:24};var In=We({name:"QChip",props:{..._l,...oo,dense:Boolean,icon:String,iconRight:String,iconRemove:String,iconSelected:String,label:[String,Number],color:String,textColor:String,modelValue:{type:Boolean,default:!0},selected:{type:Boolean,default:null},square:Boolean,outline:Boolean,clickable:Boolean,removable:Boolean,removeAriaLabel:String,tabindex:[String,Number],disable:Boolean,ripple:{type:[Boolean,Object],default:!0}},emits:["update:modelValue","update:selected","remove","click"],setup(e,{slots:t,emit:n}){const{proxy:{$q:o}}=Ne(),s=kl(e,o),a=no(e,An),i=C(()=>e.selected===!0||e.icon!==void 0),d=C(()=>e.selected===!0?e.iconSelected||o.iconSet.chip.selected:e.icon),m=C(()=>e.iconRemove||o.iconSet.chip.remove),p=C(()=>e.disable===!1&&(e.clickable===!0||e.selected!==null)),c=C(()=>{const x=e.outline===!0&&e.color||e.textColor;return"q-chip row inline no-wrap items-center"+(e.outline===!1&&e.color!==void 0?` bg-${e.color}`:"")+(x?` text-${x} q-chip--colored`:"")+(e.disable===!0?" disabled":"")+(e.dense===!0?" q-chip--dense":"")+(e.outline===!0?" q-chip--outline":"")+(e.selected===!0?" q-chip--selected":"")+(p.value===!0?" q-chip--clickable cursor-pointer non-selectable q-hoverable":"")+(e.square===!0?" q-chip--square":"")+(s.value===!0?" q-chip--dark q-dark":"")}),v=C(()=>{const x=e.disable===!0?{tabindex:-1,"aria-disabled":"true"}:{tabindex:e.tabindex||0},$={...x,role:"button","aria-hidden":"false","aria-label":e.removeAriaLabel||o.lang.label.remove};return{chip:x,remove:$}});function w(x){x.keyCode===13&&f(x)}function f(x){e.disable||(n("update:selected",!e.selected),n("click",x))}function _(x){(x.keyCode===void 0||x.keyCode===13)&&(we(x),e.disable===!1&&(n("update:modelValue",!1),n("remove")))}function I(){const x=[];p.value===!0&&x.push(F("div",{class:"q-focus-helper"})),i.value===!0&&x.push(F($e,{class:"q-chip__icon q-chip__icon--left",name:d.value}));const $=e.label!==void 0?[F("div",{class:"ellipsis"},[e.label])]:void 0;return x.push(F("div",{class:"q-chip__content col row no-wrap items-center q-anchor--skip"},io(t.default,$))),e.iconRight&&x.push(F($e,{class:"q-chip__icon q-chip__icon--right",name:e.iconRight})),e.removable===!0&&x.push(F($e,{class:"q-chip__icon q-chip__icon--remove cursor-pointer",name:m.value,...v.value.remove,onClick:_,onKeyup:_})),x}return()=>{if(e.modelValue===!1)return;const x={class:c.value,style:a.value};return p.value===!0&&Object.assign(x,v.value.chip,{onClick:f,onKeyup:w}),ao("div",x,I(),"ripple",e.ripple!==!1&&e.disable!==!0,()=>[[ro,e.ripple]])}}});const En={target:{default:!0},noParentEvent:Boolean,contextMenu:Boolean};function Pn({showing:e,avoidEmit:t,configureAnchorEl:n}){const{props:o,proxy:s,emit:a}=Ne(),i=k(null);let d=null;function m(f){return i.value===null?!1:f===void 0||f.touches===void 0||f.touches.length<=1}const p={};n===void 0&&(Object.assign(p,{hide(f){s.hide(f)},toggle(f){s.toggle(f),f.qAnchorHandled=!0},toggleKey(f){Mt(f,13)===!0&&p.toggle(f)},contextClick(f){s.hide(f),et(f),ge(()=>{s.show(f),f.qAnchorHandled=!0})},prevent:et,mobileTouch(f){if(p.mobileCleanup(f),m(f)!==!0)return;s.hide(f),i.value.classList.add("non-selectable");const _=f.target;Gt(p,"anchor",[[_,"touchmove","mobileCleanup","passive"],[_,"touchend","mobileCleanup","passive"],[_,"touchcancel","mobileCleanup","passive"],[i.value,"contextmenu","prevent","notPassive"]]),d=setTimeout(()=>{d=null,s.show(f),f.qAnchorHandled=!0},300)},mobileCleanup(f){i.value.classList.remove("non-selectable"),d!==null&&(clearTimeout(d),d=null),e.value===!0&&f!==void 0&&Xo()}}),n=function(f=o.contextMenu){if(o.noParentEvent===!0||i.value===null)return;let _;f===!0?s.$q.platform.is.mobile===!0?_=[[i.value,"touchstart","mobileTouch","passive"]]:_=[[i.value,"mousedown","hide","passive"],[i.value,"contextmenu","contextClick","notPassive"]]:_=[[i.value,"click","toggle","passive"],[i.value,"keyup","toggleKey","passive"]],Gt(p,"anchor",_)});function c(){so(p,"anchor")}function v(f){for(i.value=f;i.value.classList.contains("q-anchor--skip");)i.value=i.value.parentNode;n()}function w(){if(o.target===!1||o.target===""||s.$el.parentNode===null)i.value=null;else if(o.target===!0)v(s.$el.parentNode);else{let f=o.target;if(typeof o.target=="string")try{f=document.querySelector(o.target)}catch{f=void 0}f!=null?(i.value=f.$el||f,n()):(i.value=null,console.error(`Anchor: target "${o.target}" not found`))}}return ie(()=>o.contextMenu,f=>{i.value!==null&&(c(),n(f))}),ie(()=>o.target,()=>{i.value!==null&&c(),w()}),ie(()=>o.noParentEvent,f=>{i.value!==null&&(f===!0?c():n())}),uo(()=>{w(),t!==!0&&o.modelValue===!0&&i.value===null&&a("update:modelValue",!1)}),nt(()=>{d!==null&&clearTimeout(d),c()}),{anchorEl:i,canShow:m,anchorEvents:p}}function On(e,t){const n=k(null);let o;function s(d,m){const p=`${m!==void 0?"add":"remove"}EventListener`,c=m!==void 0?m:o;d!==window&&d[p]("scroll",c,Tt.passive),window[p]("scroll",c,Tt.passive),o=m}function a(){n.value!==null&&(s(n.value),n.value=null)}const i=ie(()=>e.noParentEvent,()=>{n.value!==null&&(a(),t())});return nt(i),{localScrollTarget:n,unconfigureScrollTarget:a,changeScrollEvent:s}}const{notPassiveCapture:ft}=Tt,De=[];function vt(e){const t=e.target;if(t===void 0||t.nodeType===8||t.classList.contains("no-pointer-events")===!0)return;let n=Jt.length-1;for(;n>=0;){const o=Jt[n].$;if(o.type.name==="QTooltip"){n--;continue}if(o.type.name!=="QDialog")break;if(o.props.seamless!==!0)return;n--}for(let o=De.length-1;o>=0;o--){const s=De[o];if((s.anchorEl.value===null||s.anchorEl.value.contains(t)===!1)&&(t===document.body||s.innerRef.value!==null&&s.innerRef.value.contains(t)===!1))e.qClickOutside=!0,s.onClickOutside(e);else return}}function Rn(e){De.push(e),De.length===1&&(document.addEventListener("mousedown",vt,ft),document.addEventListener("touchstart",vt,ft))}function nl(e){const t=De.findIndex(n=>n===e);t!==-1&&(De.splice(t,1),De.length===0&&(document.removeEventListener("mousedown",vt,ft),document.removeEventListener("touchstart",vt,ft)))}let al,il;function rl(e){const t=e.split(" ");return t.length!==2?!1:["top","center","bottom"].includes(t[0])!==!0?(console.error("Anchor/Self position must start with one of top/center/bottom"),!1):["left","middle","right","start","end"].includes(t[1])!==!0?(console.error("Anchor/Self position must end with one of left/middle/right/start/end"),!1):!0}function $n(e){return e?!(e.length!==2||typeof e[0]!="number"||typeof e[1]!="number"):!0}const zt={"start#ltr":"left","start#rtl":"right","end#ltr":"right","end#rtl":"left"};["left","middle","right"].forEach(e=>{zt[`${e}#ltr`]=e,zt[`${e}#rtl`]=e});function ul(e,t){const n=e.split(" ");return{vertical:n[0],horizontal:zt[`${n[1]}#${t===!0?"rtl":"ltr"}`]}}function Bn(e,t){let{top:n,left:o,right:s,bottom:a,width:i,height:d}=e.getBoundingClientRect();return t!==void 0&&(n-=t[1],o-=t[0],a+=t[1],s+=t[0],i+=t[0],d+=t[1]),{top:n,bottom:a,height:d,left:o,right:s,width:i,middle:o+(s-o)/2,center:n+(a-n)/2}}function Hn(e,t,n){let{top:o,left:s}=e.getBoundingClientRect();return o+=t.top,s+=t.left,n!==void 0&&(o+=n[1],s+=n[0]),{top:o,bottom:o+1,height:1,left:s,right:s+1,width:1,middle:s,center:o}}function Nn(e,t){return{top:0,center:t/2,bottom:t,left:0,middle:e/2,right:e}}function sl(e,t,n,o){return{top:e[n.vertical]-t[o.vertical],left:e[n.horizontal]-t[o.horizontal]}}function Vl(e,t=0){if(e.targetEl===null||e.anchorEl===null||t>5)return;if(e.targetEl.offsetHeight===0||e.targetEl.offsetWidth===0){setTimeout(()=>{Vl(e,t+1)},10);return}const{targetEl:n,offset:o,anchorEl:s,anchorOrigin:a,selfOrigin:i,absoluteOffset:d,fit:m,cover:p,maxHeight:c,maxWidth:v}=e;if(co.is.ios===!0&&window.visualViewport!==void 0){const E=document.body.style,{offsetLeft:U,offsetTop:j}=window.visualViewport;U!==al&&(E.setProperty("--q-pe-left",U+"px"),al=U),j!==il&&(E.setProperty("--q-pe-top",j+"px"),il=j)}const{scrollLeft:w,scrollTop:f}=n,_=d===void 0?Bn(s,p===!0?[0,0]:o):Hn(s,d,o);Object.assign(n.style,{top:0,left:0,minWidth:null,minHeight:null,maxWidth:v||"100vw",maxHeight:c||"100vh",visibility:"visible"});const{offsetWidth:I,offsetHeight:x}=n,{elWidth:$,elHeight:te}=m===!0||p===!0?{elWidth:Math.max(_.width,I),elHeight:p===!0?Math.max(_.height,x):x}:{elWidth:I,elHeight:x};let M={maxWidth:v,maxHeight:c};(m===!0||p===!0)&&(M.minWidth=_.width+"px",p===!0&&(M.minHeight=_.height+"px")),Object.assign(n.style,M);const A=Nn($,te);let H=sl(_,A,a,i);if(d===void 0||o===void 0)Vt(H,_,A,a,i);else{const{top:E,left:U}=H;Vt(H,_,A,a,i);let j=!1;if(H.top!==E){j=!0;const G=2*o[1];_.center=_.top-=G,_.bottom-=G+2}if(H.left!==U){j=!0;const G=2*o[0];_.middle=_.left-=G,_.right-=G+2}j===!0&&(H=sl(_,A,a,i),Vt(H,_,A,a,i))}M={top:H.top+"px",left:H.left+"px"},H.maxHeight!==void 0&&(M.maxHeight=H.maxHeight+"px",_.height>H.maxHeight&&(M.minHeight=M.maxHeight)),H.maxWidth!==void 0&&(M.maxWidth=H.maxWidth+"px",_.width>H.maxWidth&&(M.minWidth=M.maxWidth)),Object.assign(n.style,M),n.scrollTop!==f&&(n.scrollTop=f),n.scrollLeft!==w&&(n.scrollLeft=w)}function Vt(e,t,n,o,s){const a=n.bottom,i=n.right,d=fo(),m=window.innerHeight-d,p=document.body.clientWidth;if(e.top<0||e.top+a>m)if(s.vertical==="center")e.top=t[o.vertical]>m/2?Math.max(0,m-a):0,e.maxHeight=Math.min(a,m);else if(t[o.vertical]>m/2){const c=Math.min(m,o.vertical==="center"?t.center:o.vertical===s.vertical?t.bottom:t.top);e.maxHeight=Math.min(a,c),e.top=Math.max(0,c-a)}else e.top=Math.max(0,o.vertical==="center"?t.center:o.vertical===s.vertical?t.top:t.bottom),e.maxHeight=Math.min(a,m-e.top);if(e.left<0||e.left+i>p)if(e.maxWidth=Math.min(i,p),s.horizontal==="middle")e.left=t[o.horizontal]>p/2?Math.max(0,p-i):0;else if(t[o.horizontal]>p/2){const c=Math.min(p,o.horizontal==="middle"?t.middle:o.horizontal===s.horizontal?t.right:t.left);e.maxWidth=Math.min(i,c),e.left=Math.max(0,c-e.maxWidth)}else e.left=Math.max(0,o.horizontal==="middle"?t.middle:o.horizontal===s.horizontal?t.left:t.right),e.maxWidth=Math.min(i,p-e.left)}var Wn=We({name:"QMenu",inheritAttrs:!1,props:{...En,...vo,..._l,...mo,persistent:Boolean,autoClose:Boolean,separateClosePopup:Boolean,noRouteDismiss:Boolean,noRefocus:Boolean,noFocus:Boolean,fit:Boolean,cover:Boolean,square:Boolean,anchor:{type:String,validator:rl},self:{type:String,validator:rl},offset:{type:Array,validator:$n},scrollTarget:{default:void 0},touchPosition:Boolean,maxHeight:{type:String,default:null},maxWidth:{type:String,default:null}},emits:[...ho,"click","escapeKey"],setup(e,{slots:t,emit:n,attrs:o}){let s=null,a,i,d;const m=Ne(),{proxy:p}=m,{$q:c}=p,v=k(null),w=k(!1),f=C(()=>e.persistent!==!0&&e.noRouteDismiss!==!0),_=kl(e,c),{registerTick:I,removeTick:x}=go(),{registerTimeout:$}=yo(),{transitionProps:te,transitionStyle:M}=po(e),{localScrollTarget:A,changeScrollEvent:H,unconfigureScrollTarget:E}=On(e,q),{anchorEl:U,canShow:j}=Pn({showing:w}),{hide:G}=So({showing:w,canShow:j,handleShow:Ce,handleHide:u,hideOnRouteChange:f,processOnMount:!0}),{showPortal:ue,hidePortal:_e,renderPortal:Z}=bo(m,v,W,"menu"),he={anchorEl:U,innerRef:v,onClickOutside(g){if(e.persistent!==!0&&w.value===!0)return G(g),(g.type==="touchstart"||g.target.classList.contains("q-dialog__backdrop"))&&we(g),!0}},ke=C(()=>ul(e.anchor||(e.cover===!0?"center middle":"bottom start"),c.lang.rtl)),Se=C(()=>e.cover===!0?ke.value:ul(e.self||"top start",c.lang.rtl)),ne=C(()=>(e.square===!0?" q-menu--square":"")+(_.value===!0?" q-menu--dark q-dark":"")),Ue=C(()=>e.autoClose===!0?{onClick:P}:{}),be=C(()=>w.value===!0&&e.persistent!==!0);ie(be,g=>{g===!0?(wo(T),Rn(he)):(el(T),nl(he))});function se(){qo(()=>{let g=v.value;g&&g.contains(document.activeElement)!==!0&&(g=g.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||g.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||g.querySelector("[autofocus], [data-autofocus]")||g,g.focus({preventScroll:!0}))})}function Ce(g){if(s=e.noRefocus===!1?document.activeElement:null,_o(N),ue(),q(),a=void 0,g!==void 0&&(e.touchPosition||e.contextMenu)){const K=ko(g);if(K.left!==void 0){const{top:ce,left:ze}=U.value.getBoundingClientRect();a={left:K.left-ze,top:K.top-ce}}}i===void 0&&(i=ie(()=>c.screen.width+"|"+c.screen.height+"|"+e.self+"|"+e.anchor+"|"+c.lang.rtl,L)),e.noFocus!==!0&&document.activeElement.blur(),I(()=>{L(),e.noFocus!==!0&&se()}),$(()=>{c.platform.is.ios===!0&&(d=e.autoClose,v.value.click()),L(),ue(!0),n("show",g)},e.transitionDuration)}function u(g){x(),_e(),S(!0),s!==null&&(g===void 0||g.qClickOutside!==!0)&&(((g&&g.type.indexOf("key")===0?s.closest('[tabindex]:not([tabindex^="-"])'):void 0)||s).focus(),s=null),$(()=>{_e(!0),n("hide",g)},e.transitionDuration)}function S(g){a=void 0,i!==void 0&&(i(),i=void 0),(g===!0||w.value===!0)&&(Co(N),E(),nl(he),el(T)),g!==!0&&(s=null)}function q(){(U.value!==null||e.scrollTarget!==void 0)&&(A.value=xo(U.value,e.scrollTarget),H(A.value,L))}function P(g){d!==!0?(Vo(p,g),n("click",g)):d=!1}function N(g){be.value===!0&&e.noFocus!==!0&&Fo(v.value,g.target)!==!0&&se()}function T(g){n("escapeKey"),G(g)}function L(){Vl({targetEl:v.value,offset:e.offset,anchorEl:U.value,anchorOrigin:ke.value,selfOrigin:Se.value,absoluteOffset:a,fit:e.fit,cover:e.cover,maxHeight:e.maxHeight,maxWidth:e.maxWidth})}function W(){return F(Lo,te.value,()=>w.value===!0?F("div",{role:"menu",...o,ref:v,tabindex:-1,class:["q-menu q-position-engine scroll"+ne.value,o.class],style:[o.style,M.value],...Ue.value},vl(t.default)):null)}return nt(S),Object.assign(p,{focus:se,updatePosition:L}),Z}});let mt=!1;{const e=document.createElement("div");e.setAttribute("dir","rtl"),Object.assign(e.style,{width:"1px",height:"1px",overflow:"auto"});const t=document.createElement("div");Object.assign(t.style,{width:"1000px",height:"1px"}),document.body.appendChild(e),e.appendChild(t),e.scrollLeft=-1e3,mt=e.scrollLeft>=0,e.remove()}const re=1e3,Qn=["start","center","end","start-force","center-force","end-force"],Ll=Array.prototype.filter,Un=window.getComputedStyle(document.body).overflowAnchor===void 0?To:function(e,t){e!==null&&(e._qOverflowAnimationFrame!==void 0&&cancelAnimationFrame(e._qOverflowAnimationFrame),e._qOverflowAnimationFrame=requestAnimationFrame(()=>{if(e===null)return;e._qOverflowAnimationFrame=void 0;const n=e.children||[];Ll.call(n,s=>s.dataset&&s.dataset.qVsAnchor!==void 0).forEach(s=>{delete s.dataset.qVsAnchor});const o=n[t];o&&o.dataset&&(o.dataset.qVsAnchor="")}))};function He(e,t){return e+t}function Lt(e,t,n,o,s,a,i,d){const m=e===window?document.scrollingElement||document.documentElement:e,p=s===!0?"offsetWidth":"offsetHeight",c={scrollStart:0,scrollViewSize:-i-d,scrollMaxSize:0,offsetStart:-i,offsetEnd:-d};if(s===!0?(e===window?(c.scrollStart=window.pageXOffset||window.scrollX||document.body.scrollLeft||0,c.scrollViewSize+=document.documentElement.clientWidth):(c.scrollStart=m.scrollLeft,c.scrollViewSize+=m.clientWidth),c.scrollMaxSize=m.scrollWidth,a===!0&&(c.scrollStart=(mt===!0?c.scrollMaxSize-c.scrollViewSize:0)-c.scrollStart)):(e===window?(c.scrollStart=window.pageYOffset||window.scrollY||document.body.scrollTop||0,c.scrollViewSize+=document.documentElement.clientHeight):(c.scrollStart=m.scrollTop,c.scrollViewSize+=m.clientHeight),c.scrollMaxSize=m.scrollHeight),n!==null)for(let v=n.previousElementSibling;v!==null;v=v.previousElementSibling)v.classList.contains("q-virtual-scroll--skip")===!1&&(c.offsetStart+=v[p]);if(o!==null)for(let v=o.nextElementSibling;v!==null;v=v.nextElementSibling)v.classList.contains("q-virtual-scroll--skip")===!1&&(c.offsetEnd+=v[p]);if(t!==e){const v=m.getBoundingClientRect(),w=t.getBoundingClientRect();s===!0?(c.offsetStart+=w.left-v.left,c.offsetEnd-=w.width):(c.offsetStart+=w.top-v.top,c.offsetEnd-=w.height),e!==window&&(c.offsetStart+=c.scrollStart),c.offsetEnd+=c.scrollMaxSize-c.offsetStart}return c}function cl(e,t,n,o){t==="end"&&(t=(e===window?document.body:e)[n===!0?"scrollWidth":"scrollHeight"]),e===window?n===!0?(o===!0&&(t=(mt===!0?document.body.scrollWidth-document.documentElement.clientWidth:0)-t),window.scrollTo(t,window.pageYOffset||window.scrollY||document.body.scrollTop||0)):window.scrollTo(window.pageXOffset||window.scrollX||document.body.scrollLeft||0,t):n===!0?(o===!0&&(t=(mt===!0?e.scrollWidth-e.offsetWidth:0)-t),e.scrollLeft=t):e.scrollTop=t}function Ge(e,t,n,o){if(n>=o)return 0;const s=t.length,a=Math.floor(n/re),i=Math.floor((o-1)/re)+1;let d=e.slice(a,i).reduce(He,0);return n%re!==0&&(d-=t.slice(a*re,n).reduce(He,0)),o%re!==0&&o!==s&&(d-=t.slice(o,i*re).reduce(He,0)),d}const jn={virtualScrollSliceSize:{type:[Number,String],default:null},virtualScrollSliceRatioBefore:{type:[Number,String],default:1},virtualScrollSliceRatioAfter:{type:[Number,String],default:1},virtualScrollItemSize:{type:[Number,String],default:24},virtualScrollStickySizeStart:{type:[Number,String],default:0},virtualScrollStickySizeEnd:{type:[Number,String],default:0},tableColspan:[Number,String]},Kn={virtualScrollHorizontal:Boolean,onVirtualScroll:Function,...jn};function Xn({virtualScrollLength:e,getVirtualScrollTarget:t,getVirtualScrollEl:n,virtualScrollItemSizeComputed:o}){const s=Ne(),{props:a,emit:i,proxy:d}=s,{$q:m}=d;let p,c,v,w=[],f;const _=k(0),I=k(0),x=k({}),$=k(null),te=k(null),M=k(null),A=k({from:0,to:0}),H=C(()=>a.tableColspan!==void 0?a.tableColspan:100);o===void 0&&(o=C(()=>a.virtualScrollItemSize));const E=C(()=>o.value+";"+a.virtualScrollHorizontal),U=C(()=>E.value+";"+a.virtualScrollSliceRatioBefore+";"+a.virtualScrollSliceRatioAfter);ie(U,()=>{ne()}),ie(E,j);function j(){Se(c,!0)}function G(u){Se(u===void 0?c:u)}function ue(u,S){const q=t();if(q==null||q.nodeType===8)return;const P=Lt(q,n(),$.value,te.value,a.virtualScrollHorizontal,m.lang.rtl,a.virtualScrollStickySizeStart,a.virtualScrollStickySizeEnd);v!==P.scrollViewSize&&ne(P.scrollViewSize),Z(q,P,Math.min(e.value-1,Math.max(0,parseInt(u,10)||0)),0,Qn.indexOf(S)!==-1?S:c!==-1&&u>c?"end":"start")}function _e(){const u=t();if(u==null||u.nodeType===8)return;const S=Lt(u,n(),$.value,te.value,a.virtualScrollHorizontal,m.lang.rtl,a.virtualScrollStickySizeStart,a.virtualScrollStickySizeEnd),q=e.value-1,P=S.scrollMaxSize-S.offsetStart-S.offsetEnd-I.value;if(p===S.scrollStart)return;if(S.scrollMaxSize<=0){Z(u,S,0,0);return}v!==S.scrollViewSize&&ne(S.scrollViewSize),he(A.value.from);const N=Math.floor(S.scrollMaxSize-Math.max(S.scrollViewSize,S.offsetEnd)-Math.min(f[q],S.scrollViewSize/2));if(N>0&&Math.ceil(S.scrollStart)>=N){Z(u,S,q,S.scrollMaxSize-S.offsetEnd-w.reduce(He,0));return}let T=0,L=S.scrollStart-S.offsetStart,W=L;if(L<=P&&L+S.scrollViewSize>=_.value)L-=_.value,T=A.value.from,W=L;else for(let g=0;L>=w[g]&&T<q;g++)L-=w[g],T+=re;for(;L>0&&T<q;)L-=f[T],L>-S.scrollViewSize?(T++,W=L):W=f[T]+L;Z(u,S,T,W)}function Z(u,S,q,P,N){const T=typeof N=="string"&&N.indexOf("-force")!==-1,L=T===!0?N.replace("-force",""):N,W=L!==void 0?L:"start";let g=Math.max(0,q-x.value[W]),K=g+x.value.total;K>e.value&&(K=e.value,g=Math.max(0,K-x.value.total)),p=S.scrollStart;const ce=g!==A.value.from||K!==A.value.to;if(ce===!1&&L===void 0){be(q);return}const{activeElement:ze}=document,de=M.value;ce===!0&&de!==null&&de!==ze&&de.contains(ze)===!0&&(de.addEventListener("focusout",ke),setTimeout(()=>{de!==null&&de.removeEventListener("focusout",ke)})),Un(de,q-g);const at=L!==void 0?f.slice(g,q).reduce(He,0):0;if(ce===!0){const xe=K>=A.value.from&&g<=A.value.to?A.value.to:K;A.value={from:g,to:xe},_.value=Ge(w,f,0,g),I.value=Ge(w,f,K,e.value),requestAnimationFrame(()=>{A.value.to!==K&&p===S.scrollStart&&(A.value={from:A.value.from,to:K},I.value=Ge(w,f,K,e.value))})}requestAnimationFrame(()=>{if(p!==S.scrollStart)return;ce===!0&&he(g);const xe=f.slice(g,q).reduce(He,0),Ve=xe+S.offsetStart+_.value,it=Ve+f[q];let je=Ve+P;if(L!==void 0){const yt=xe-at,Ke=S.scrollStart+yt;je=T!==!0&&Ke<Ve&&it<Ke+S.scrollViewSize?Ke:L==="end"?it-S.scrollViewSize:Ve-(L==="start"?0:Math.round((S.scrollViewSize-f[q])/2))}p=je,cl(u,je,a.virtualScrollHorizontal,m.lang.rtl),be(q)})}function he(u){const S=M.value;if(S){const q=Ll.call(S.children,g=>g.classList&&g.classList.contains("q-virtual-scroll--skip")===!1),P=q.length,N=a.virtualScrollHorizontal===!0?g=>g.getBoundingClientRect().width:g=>g.offsetHeight;let T=u,L,W;for(let g=0;g<P;){for(L=N(q[g]),g++;g<P&&q[g].classList.contains("q-virtual-scroll--with-prev")===!0;)L+=N(q[g]),g++;W=L-f[T],W!==0&&(f[T]+=W,w[Math.floor(T/re)]+=W),T++}}}function ke(){M.value!==null&&M.value!==void 0&&M.value.focus()}function Se(u,S){const q=1*o.value;(S===!0||Array.isArray(f)===!1)&&(f=[]);const P=f.length;f.length=e.value;for(let T=e.value-1;T>=P;T--)f[T]=q;const N=Math.floor((e.value-1)/re);w=[];for(let T=0;T<=N;T++){let L=0;const W=Math.min((T+1)*re,e.value);for(let g=T*re;g<W;g++)L+=f[g];w.push(L)}c=-1,p=void 0,_.value=Ge(w,f,0,A.value.from),I.value=Ge(w,f,A.value.to,e.value),u>=0?(he(A.value.from),ge(()=>{ue(u)})):se()}function ne(u){if(u===void 0&&typeof window!="undefined"){const L=t();L!=null&&L.nodeType!==8&&(u=Lt(L,n(),$.value,te.value,a.virtualScrollHorizontal,m.lang.rtl,a.virtualScrollStickySizeStart,a.virtualScrollStickySizeEnd).scrollViewSize)}v=u;const S=parseFloat(a.virtualScrollSliceRatioBefore)||0,q=parseFloat(a.virtualScrollSliceRatioAfter)||0,P=1+S+q,N=u===void 0||u<=0?1:Math.ceil(u/o.value),T=Math.max(1,N,Math.ceil((a.virtualScrollSliceSize>0?a.virtualScrollSliceSize:10)/P));x.value={total:Math.ceil(T*P),start:Math.ceil(T*S),center:Math.ceil(T*(.5+S)),end:Math.ceil(T*(1+S)),view:N}}function Ue(u,S){const q=a.virtualScrollHorizontal===!0?"width":"height",P={["--q-virtual-scroll-item-"+q]:o.value+"px"};return[u==="tbody"?F(u,{class:"q-virtual-scroll__padding",key:"before",ref:$},[F("tr",[F("td",{style:{[q]:`${_.value}px`,...P},colspan:H.value})])]):F(u,{class:"q-virtual-scroll__padding",key:"before",ref:$,style:{[q]:`${_.value}px`,...P}}),F(u,{class:"q-virtual-scroll__content",key:"content",ref:M,tabindex:-1},S.flat()),u==="tbody"?F(u,{class:"q-virtual-scroll__padding",key:"after",ref:te},[F("tr",[F("td",{style:{[q]:`${I.value}px`,...P},colspan:H.value})])]):F(u,{class:"q-virtual-scroll__padding",key:"after",ref:te,style:{[q]:`${I.value}px`,...P}})]}function be(u){c!==u&&(a.onVirtualScroll!==void 0&&i("virtualScroll",{index:u,from:A.value.from,to:A.value.to-1,direction:u<c?"decrease":"increase",ref:d}),c=u)}ne();const se=Do(_e,m.platform.is.ios===!0?120:35);zo(()=>{ne()});let Ce=!1;return Mo(()=>{Ce=!0}),Ao(()=>{if(Ce!==!0)return;const u=t();p!==void 0&&u!==void 0&&u!==null&&u.nodeType!==8?cl(u,p,a.virtualScrollHorizontal,m.lang.rtl):ue(c)}),nt(()=>{se.cancel()}),Object.assign(d,{scrollTo:ue,reset:j,refresh:G}),{virtualScrollSliceRange:A,virtualScrollSliceSizeComputed:x,setVirtualScrollSize:ne,onVirtualScrollEvt:se,localResetVirtualScroll:Se,padVirtualScroll:Ue,scrollTo:ue,reset:j,refresh:G}}const dl=e=>["add","add-unique","toggle"].includes(e),Yn=".*+?^${}()|[]\\",Zn=Object.keys(At);var qt=We({name:"QSelect",inheritAttrs:!1,props:{...Kn,...Io,...At,modelValue:{required:!0},multiple:Boolean,displayValue:[String,Number],displayValueHtml:Boolean,dropdownIcon:String,options:{type:Array,default:()=>[]},optionValue:[Function,String],optionLabel:[Function,String],optionDisable:[Function,String],hideSelected:Boolean,hideDropdownIcon:Boolean,fillInput:Boolean,maxValues:[Number,String],optionsDense:Boolean,optionsDark:{type:Boolean,default:null},optionsSelectedClass:String,optionsHtml:Boolean,optionsCover:Boolean,menuShrink:Boolean,menuAnchor:String,menuSelf:String,menuOffset:Array,popupContentClass:String,popupContentStyle:[String,Array,Object],popupNoRouteDismiss:Boolean,useInput:Boolean,useChips:Boolean,newValueMode:{type:String,validator:dl},mapOptions:Boolean,emitValue:Boolean,inputDebounce:{type:[Number,String],default:500},inputClass:[Array,String,Object],inputStyle:[Array,String,Object],tabindex:{type:[String,Number],default:0},autocomplete:String,transitionShow:String,transitionHide:String,transitionDuration:[String,Number],behavior:{type:String,validator:e=>["default","menu","dialog"].includes(e),default:"default"},virtualScrollItemSize:{type:[Number,String],default:void 0},onNewValue:Function,onFilter:Function},emits:[...Sl,"add","remove","inputValue","newValue","keyup","keypress","keydown","filterAbort"],setup(e,{slots:t,emit:n}){const{proxy:o}=Ne(),{$q:s}=o,a=k(!1),i=k(!1),d=k(-1),m=k(""),p=k(!1),c=k(!1);let v=null,w=null,f,_,I,x=null,$,te,M,A;const H=k(null),E=k(null),U=k(null),j=k(null),G=k(null),ue=Eo(e),_e=Ro(Wt),Z=C(()=>Array.isArray(e.options)?e.options.length:0),he=C(()=>e.virtualScrollItemSize===void 0?e.optionsDense===!0?24:48:e.virtualScrollItemSize),{virtualScrollSliceRange:ke,virtualScrollSliceSizeComputed:Se,localResetVirtualScroll:ne,padVirtualScroll:Ue,onVirtualScrollEvt:be,scrollTo:se,setVirtualScrollSize:Ce}=Xn({virtualScrollLength:Z,getVirtualScrollTarget:Dl,getVirtualScrollEl:Ht,virtualScrollItemSizeComputed:he}),u=wl(),S=C(()=>{const l=e.mapOptions===!0&&e.multiple!==!0,b=e.modelValue!==void 0&&(e.modelValue!==null||l===!0)?e.multiple===!0&&Array.isArray(e.modelValue)?e.modelValue:[e.modelValue]:[];if(e.mapOptions===!0&&Array.isArray(e.options)===!0){const y=e.mapOptions===!0&&f!==void 0?f:[],V=b.map(R=>Tl(R,y));return e.modelValue===null&&l===!0?V.filter(R=>R!==null):V}return b}),q=C(()=>{const l={};return Zn.forEach(b=>{const y=e[b];y!==void 0&&(l[b]=y)}),l}),P=C(()=>e.optionsDark===null?u.isDark.value:e.optionsDark),N=C(()=>tl(S.value)),T=C(()=>{let l="q-field__input q-placeholder col";return e.hideSelected===!0||S.value.length===0?[l,e.inputClass]:(l+=" q-field__input--padding",e.inputClass===void 0?l:[l,e.inputClass])}),L=C(()=>(e.virtualScrollHorizontal===!0?"q-virtual-scroll--horizontal":"")+(e.popupContentClass?" "+e.popupContentClass:"")),W=C(()=>Z.value===0),g=C(()=>S.value.map(l=>le.value(l)).join(", ")),K=C(()=>e.displayValue!==void 0?e.displayValue:g.value),ce=C(()=>e.optionsHtml===!0?()=>!0:l=>l!=null&&l.html===!0),ze=C(()=>e.displayValueHtml===!0||e.displayValue===void 0&&(e.optionsHtml===!0||S.value.some(ce.value))),de=C(()=>u.focused.value===!0?e.tabindex:-1),at=C(()=>{const l={tabindex:e.tabindex,role:"combobox","aria-label":e.label,"aria-readonly":e.readonly===!0?"true":"false","aria-autocomplete":e.useInput===!0?"list":"none","aria-expanded":a.value===!0?"true":"false","aria-controls":`${u.targetUid.value}_lb`};return d.value>=0&&(l["aria-activedescendant"]=`${u.targetUid.value}_${d.value}`),l}),xe=C(()=>({id:`${u.targetUid.value}_lb`,role:"listbox","aria-multiselectable":e.multiple===!0?"true":"false"})),Ve=C(()=>S.value.map((l,b)=>({index:b,opt:l,html:ce.value(l),selected:!0,removeAtIndex:Fl,toggleOption:Le,tabindex:de.value}))),it=C(()=>{if(Z.value===0)return[];const{from:l,to:b}=ke.value;return e.options.slice(l,b).map((y,V)=>{const R=Me.value(y)===!0,O=bt(y)===!0,X=l+V,Q={clickable:!0,active:O,activeClass:Ke.value,manualFocus:!0,focused:!1,disable:R,tabindex:-1,dense:e.optionsDense,dark:P.value,role:"option","aria-selected":O===!0?"true":"false",id:`${u.targetUid.value}_${X}`,onClick:()=>{Le(y)}};return R!==!0&&(d.value===X&&(Q.focused=!0),s.platform.is.desktop===!0&&(Q.onMousemove=()=>{a.value===!0&&Ae(X)})),{index:X,opt:y,html:ce.value(y),label:le.value(y),selected:Q.active,focused:Q.focused,toggleOption:Le,setOptionIndex:Ae,itemProps:Q}})}),je=C(()=>e.dropdownIcon!==void 0?e.dropdownIcon:s.iconSet.arrow.dropdown),yt=C(()=>e.optionsCover===!1&&e.outlined!==!0&&e.standout!==!0&&e.borderless!==!0&&e.rounded!==!0),Ke=C(()=>e.optionsSelectedClass!==void 0?e.optionsSelectedClass:e.color!==void 0?`text-${e.color}`:""),fe=C(()=>St(e.optionValue,"value")),le=C(()=>St(e.optionLabel,"label")),Me=C(()=>St(e.optionDisable,"disable")),rt=C(()=>S.value.map(l=>fe.value(l))),ql=C(()=>{const l={onInput:Wt,onChange:_e,onKeydown:Bt,onKeyup:Rt,onKeypress:$t,onFocus:Pt,onClick(b){_===!0&&Re(b)}};return l.onCompositionstart=l.onCompositionupdate=l.onCompositionend=_e,l});ie(S,l=>{f=l,e.useInput===!0&&e.fillInput===!0&&e.multiple!==!0&&u.innerLoading.value!==!0&&(i.value!==!0&&a.value!==!0||N.value!==!0)&&(I!==!0&&Oe(),(i.value===!0||a.value===!0)&&Ie(""))},{immediate:!0}),ie(()=>e.fillInput,Oe),ie(a,wt),ie(Z,Nl);function It(l){return e.emitValue===!0?fe.value(l):l}function pt(l){if(l!==-1&&l<S.value.length)if(e.multiple===!0){const b=e.modelValue.slice();n("remove",{index:l,value:b.splice(l,1)[0]}),n("update:modelValue",b)}else n("update:modelValue",null)}function Fl(l){pt(l),u.focus()}function Et(l,b){const y=It(l);if(e.multiple!==!0){e.fillInput===!0&&Xe(le.value(l),!0,!0),n("update:modelValue",y);return}if(S.value.length===0){n("add",{index:0,value:y}),n("update:modelValue",e.multiple===!0?[y]:y);return}if(b===!0&&bt(l)===!0||e.maxValues!==void 0&&e.modelValue.length>=e.maxValues)return;const V=e.modelValue.slice();n("add",{index:V.length,value:y}),V.push(y),n("update:modelValue",V)}function Le(l,b){if(u.editable.value!==!0||l===void 0||Me.value(l)===!0)return;const y=fe.value(l);if(e.multiple!==!0){b!==!0&&(Xe(e.fillInput===!0?le.value(l):"",!0,!0),qe()),E.value!==null&&E.value.focus(),(S.value.length===0||Ze(fe.value(S.value[0]),y)!==!0)&&n("update:modelValue",e.emitValue===!0?y:l);return}if((_!==!0||p.value===!0)&&u.focus(),Pt(),S.value.length===0){const O=e.emitValue===!0?y:l;n("add",{index:0,value:O}),n("update:modelValue",e.multiple===!0?[O]:O);return}const V=e.modelValue.slice(),R=rt.value.findIndex(O=>Ze(O,y));if(R!==-1)n("remove",{index:R,value:V.splice(R,1)[0]});else{if(e.maxValues!==void 0&&V.length>=e.maxValues)return;const O=e.emitValue===!0?y:l;n("add",{index:V.length,value:O}),V.push(O)}n("update:modelValue",V)}function Ae(l){if(s.platform.is.desktop!==!0)return;const b=l!==-1&&l<Z.value?l:-1;d.value!==b&&(d.value=b)}function ut(l=1,b){if(a.value===!0){let y=d.value;do y=ll(y+l,-1,Z.value-1);while(y!==-1&&y!==d.value&&Me.value(e.options[y])===!0);d.value!==y&&(Ae(y),se(y),b!==!0&&e.useInput===!0&&e.fillInput===!0&&st(y>=0?le.value(e.options[y]):$,!0))}}function Tl(l,b){const y=V=>Ze(fe.value(V),l);return e.options.find(y)||b.find(y)||l}function St(l,b){const y=l!==void 0?l:b;return typeof y=="function"?y:V=>V!==null&&typeof V=="object"&&y in V?V[y]:V}function bt(l){const b=fe.value(l);return rt.value.find(y=>Ze(y,b))!==void 0}function Pt(l){e.useInput===!0&&E.value!==null&&(l===void 0||E.value===l.target&&l.target.value===g.value)&&E.value.select()}function Ot(l){Mt(l,27)===!0&&a.value===!0&&(Re(l),qe(),Oe()),n("keyup",l)}function Rt(l){const{value:b}=l.target;if(l.keyCode!==void 0){Ot(l);return}if(l.target.value="",v!==null&&(clearTimeout(v),v=null),w!==null&&(clearTimeout(w),w=null),Oe(),typeof b=="string"&&b.length!==0){const y=b.toLocaleLowerCase(),V=O=>{const X=e.options.find(Q=>O.value(Q).toLocaleLowerCase()===y);return X===void 0?!1:(S.value.indexOf(X)===-1?Le(X):qe(),!0)},R=O=>{V(fe)!==!0&&(V(le)===!0||O===!0||Ie(b,!0,()=>R(!0)))};R()}else u.clearValue(l)}function $t(l){n("keypress",l)}function Bt(l){if(n("keydown",l),$o(l)===!0)return;const b=m.value.length!==0&&(e.newValueMode!==void 0||e.onNewValue!==void 0),y=l.shiftKey!==!0&&e.multiple!==!0&&(d.value!==-1||b===!0);if(l.keyCode===27){et(l);return}if(l.keyCode===9&&y===!1){Ee();return}if(l.target===void 0||l.target.id!==u.targetUid.value||u.editable.value!==!0)return;if(l.keyCode===40&&u.innerLoading.value!==!0&&a.value===!1){we(l),Pe();return}if(l.keyCode===8&&(e.useChips===!0||e.clearable===!0)&&e.hideSelected!==!0&&m.value.length===0){e.multiple===!0&&Array.isArray(e.modelValue)===!0?pt(e.modelValue.length-1):e.multiple!==!0&&e.modelValue!==null&&n("update:modelValue",null);return}(l.keyCode===35||l.keyCode===36)&&(typeof m.value!="string"||m.value.length===0)&&(we(l),d.value=-1,ut(l.keyCode===36?1:-1,e.multiple)),(l.keyCode===33||l.keyCode===34)&&Se.value!==void 0&&(we(l),d.value=Math.max(-1,Math.min(Z.value,d.value+(l.keyCode===33?-1:1)*Se.value.view)),ut(l.keyCode===33?1:-1,e.multiple)),(l.keyCode===38||l.keyCode===40)&&(we(l),ut(l.keyCode===38?-1:1,e.multiple));const V=Z.value;if((M===void 0||A<Date.now())&&(M=""),V>0&&e.useInput!==!0&&l.key!==void 0&&l.key.length===1&&l.altKey===!1&&l.ctrlKey===!1&&l.metaKey===!1&&(l.keyCode!==32||M.length!==0)){a.value!==!0&&Pe(l);const R=l.key.toLocaleLowerCase(),O=M.length===1&&M[0]===R;A=Date.now()+1500,O===!1&&(we(l),M+=R);const X=new RegExp("^"+M.split("").map(_t=>Yn.indexOf(_t)!==-1?"\\"+_t:_t).join(".*"),"i");let Q=d.value;if(O===!0||Q<0||X.test(le.value(e.options[Q]))!==!0)do Q=ll(Q+1,-1,V-1);while(Q!==d.value&&(Me.value(e.options[Q])===!0||X.test(le.value(e.options[Q]))!==!0));d.value!==Q&&ge(()=>{Ae(Q),se(Q),Q>=0&&e.useInput===!0&&e.fillInput===!0&&st(le.value(e.options[Q]),!0)});return}if(!(l.keyCode!==13&&(l.keyCode!==32||e.useInput===!0||M!=="")&&(l.keyCode!==9||y===!1))){if(l.keyCode!==9&&we(l),d.value!==-1&&d.value<V){Le(e.options[d.value]);return}if(b===!0){const R=(O,X)=>{if(X){if(dl(X)!==!0)return}else X=e.newValueMode;if(Xe("",e.multiple!==!0,!0),O==null)return;(X==="toggle"?Le:Et)(O,X==="add-unique"),e.multiple!==!0&&(E.value!==null&&E.value.focus(),qe())};if(e.onNewValue!==void 0?n("newValue",m.value,R):R(m.value),e.multiple!==!0)return}a.value===!0?Ee():u.innerLoading.value!==!0&&Pe()}}function Ht(){return _===!0?G.value:U.value!==null&&U.value.contentEl!==null?U.value.contentEl:void 0}function Dl(){return Ht()}function zl(){return e.hideSelected===!0?[]:t["selected-item"]!==void 0?Ve.value.map(l=>t["selected-item"](l)).slice():t.selected!==void 0?[].concat(t.selected()):e.useChips===!0?Ve.value.map((l,b)=>F(In,{key:"option-"+b,removable:u.editable.value===!0&&Me.value(l.opt)!==!0,dense:!0,textColor:e.color,tabindex:de.value,onRemove(){l.removeAtIndex(b)}},()=>F("span",{class:"ellipsis",[l.html===!0?"innerHTML":"textContent"]:le.value(l.opt)}))):[F("span",{[ze.value===!0?"innerHTML":"textContent"]:K.value})]}function Nt(){if(W.value===!0)return t["no-option"]!==void 0?t["no-option"]({inputValue:m.value}):void 0;const l=t.option!==void 0?t.option:y=>F(Fe,{key:y.index,...y.itemProps},()=>F(ae,()=>F(ee,()=>F("span",{[y.html===!0?"innerHTML":"textContent"]:y.label}))));let b=Ue("div",it.value.map(l));return t["before-options"]!==void 0&&(b=t["before-options"]().concat(b)),Bo(t["after-options"],b)}function Ml(l,b){const y=b===!0?{...at.value,...u.splitAttrs.attributes.value}:void 0,V={ref:b===!0?E:void 0,key:"i_t",class:T.value,style:e.inputStyle,value:m.value!==void 0?m.value:"",type:"search",...y,id:b===!0?u.targetUid.value:void 0,maxlength:e.maxlength,autocomplete:e.autocomplete,"data-autofocus":l===!0||e.autofocus===!0||void 0,disabled:e.disable===!0,readonly:e.readonly===!0,...ql.value};return l!==!0&&_===!0&&(Array.isArray(V.class)===!0?V.class=[...V.class,"no-pointer-events"]:V.class+=" no-pointer-events"),F("input",V)}function Wt(l){v!==null&&(clearTimeout(v),v=null),w!==null&&(clearTimeout(w),w=null),!(l&&l.target&&l.target.qComposing===!0)&&(st(l.target.value||""),I=!0,$=m.value,u.focused.value!==!0&&(_!==!0||p.value===!0)&&u.focus(),e.onFilter!==void 0&&(v=setTimeout(()=>{v=null,Ie(m.value)},e.inputDebounce)))}function st(l,b){m.value!==l&&(m.value=l,b===!0||e.inputDebounce===0||e.inputDebounce==="0"?n("inputValue",l):w=setTimeout(()=>{w=null,n("inputValue",l)},e.inputDebounce))}function Xe(l,b,y){I=y!==!0,e.useInput===!0&&(st(l,!0),(b===!0||y!==!0)&&($=l),b!==!0&&Ie(l))}function Ie(l,b,y){if(e.onFilter===void 0||b!==!0&&u.focused.value!==!0)return;u.innerLoading.value===!0?n("filterAbort"):(u.innerLoading.value=!0,c.value=!0),l!==""&&e.multiple!==!0&&S.value.length!==0&&I!==!0&&l===le.value(S.value[0])&&(l="");const V=setTimeout(()=>{a.value===!0&&(a.value=!1)},10);x!==null&&clearTimeout(x),x=V,n("filter",l,(R,O)=>{(b===!0||u.focused.value===!0)&&x===V&&(clearTimeout(x),typeof R=="function"&&R(),c.value=!1,ge(()=>{u.innerLoading.value=!1,u.editable.value===!0&&(b===!0?a.value===!0&&qe():a.value===!0?wt(!0):a.value=!0),typeof O=="function"&&ge(()=>{O(o)}),typeof y=="function"&&ge(()=>{y(o)})}))},()=>{u.focused.value===!0&&x===V&&(clearTimeout(x),u.innerLoading.value=!1,c.value=!1),a.value===!0&&(a.value=!1)})}function Al(){return F(Wn,{ref:U,class:L.value,style:e.popupContentStyle,modelValue:a.value,fit:e.menuShrink!==!0,cover:e.optionsCover===!0&&W.value!==!0&&e.useInput!==!0,anchor:e.menuAnchor,self:e.menuSelf,offset:e.menuOffset,dark:P.value,noParentEvent:!0,noRefocus:!0,noFocus:!0,noRouteDismiss:e.popupNoRouteDismiss,square:yt.value,transitionShow:e.transitionShow,transitionHide:e.transitionHide,transitionDuration:e.transitionDuration,separateClosePopup:!0,...xe.value,onScrollPassive:be,onBeforeShow:Ut,onBeforeHide:Il,onShow:El},Nt)}function Il(l){jt(l),Ee()}function El(){Ce()}function Pl(l){Re(l),E.value!==null&&E.value.focus(),p.value=!0,window.scrollTo(window.pageXOffset||window.scrollX||document.body.scrollLeft||0,0)}function Ol(l){Re(l),ge(()=>{p.value=!1})}function Rl(){const l=[F(Mn,{class:`col-auto ${u.fieldClass.value}`,...q.value,for:u.targetUid.value,dark:P.value,square:!0,loading:c.value,itemAligned:!1,filled:!0,stackLabel:m.value.length!==0,...u.splitAttrs.listeners.value,onFocus:Pl,onBlur:Ol},{...t,rawControl:()=>u.getControl(!0),before:void 0,after:void 0})];return a.value===!0&&l.push(F("div",{ref:G,class:L.value+" scroll",style:e.popupContentStyle,...xe.value,onClick:et,onScrollPassive:be},Nt())),F(lt,{ref:j,modelValue:i.value,position:e.useInput===!0?"top":void 0,transitionShow:te,transitionHide:e.transitionHide,transitionDuration:e.transitionDuration,noRouteDismiss:e.popupNoRouteDismiss,onBeforeShow:Ut,onBeforeHide:$l,onHide:Bl,onShow:Hl},()=>F("div",{class:"q-select__dialog"+(P.value===!0?" q-select__dialog--dark q-dark":"")+(p.value===!0?" q-select__dialog--focused":"")},l))}function $l(l){jt(l),j.value!==null&&j.value.__updateRefocusTarget(u.rootRef.value.querySelector(".q-field__native > [tabindex]:last-child")),u.focused.value=!1}function Bl(l){qe(),u.focused.value===!1&&n("blur",l),Oe()}function Hl(){const l=document.activeElement;(l===null||l.id!==u.targetUid.value)&&E.value!==null&&E.value!==l&&E.value.focus(),Ce()}function Ee(){i.value!==!0&&(d.value=-1,a.value===!0&&(a.value=!1),u.focused.value===!1&&(x!==null&&(clearTimeout(x),x=null),u.innerLoading.value===!0&&(n("filterAbort"),u.innerLoading.value=!1,c.value=!1)))}function Pe(l){u.editable.value===!0&&(_===!0?(u.onControlFocusin(l),i.value=!0,ge(()=>{u.focus()})):u.focus(),e.onFilter!==void 0?Ie(m.value):(W.value!==!0||t["no-option"]!==void 0)&&(a.value=!0))}function qe(){i.value=!1,Ee()}function Oe(){e.useInput===!0&&Xe(e.multiple!==!0&&e.fillInput===!0&&S.value.length!==0&&le.value(S.value[0])||"",!0,!0)}function wt(l){let b=-1;if(l===!0){if(S.value.length!==0){const y=fe.value(S.value[0]);b=e.options.findIndex(V=>Ze(fe.value(V),y))}ne(b)}Ae(b)}function Nl(l,b){a.value===!0&&u.innerLoading.value===!1&&(ne(-1,!0),ge(()=>{a.value===!0&&u.innerLoading.value===!1&&(l>b?ne():wt(!0))}))}function Qt(){i.value===!1&&U.value!==null&&U.value.updatePosition()}function Ut(l){l!==void 0&&Re(l),n("popupShow",l),u.hasPopupOpen=!0,u.onControlFocusin(l)}function jt(l){l!==void 0&&Re(l),n("popupHide",l),u.hasPopupOpen=!1,u.onControlFocusout(l)}function Kt(){_=s.platform.is.mobile!==!0&&e.behavior!=="dialog"?!1:e.behavior!=="menu"&&(e.useInput===!0?t["no-option"]!==void 0||e.onFilter!==void 0||W.value===!1:!0),te=s.platform.is.ios===!0&&_===!0&&e.useInput===!0?"fade":e.transitionShow}return Po(Kt),Oo(Qt),Kt(),nt(()=>{v!==null&&clearTimeout(v),w!==null&&clearTimeout(w)}),Object.assign(o,{showPopup:Pe,hidePopup:qe,removeAtIndex:pt,add:Et,toggleOption:Le,getOptionIndex:()=>d.value,setOptionIndex:Ae,moveOptionSelection:ut,filter:Ie,updateMenuPosition:Qt,updateInputValue:Xe,isOptionSelected:bt,getEmittingOptionValue:It,isOptionDisabled:(...l)=>Me.value.apply(null,l)===!0,getOptionValue:(...l)=>fe.value.apply(null,l),getOptionLabel:(...l)=>le.value.apply(null,l)}),Object.assign(u,{innerValue:S,fieldClass:C(()=>`q-select q-field--auto-height q-select--with${e.useInput!==!0?"out":""}-input q-select--with${e.useChips!==!0?"out":""}-chips q-select--${e.multiple===!0?"multiple":"single"}`),inputRef:H,targetRef:E,hasValue:N,showPopup:Pe,floatingLabel:C(()=>e.hideSelected!==!0&&N.value===!0||typeof m.value=="number"||m.value.length!==0||tl(e.displayValue)),getControlChild:()=>{if(u.editable.value!==!1&&(i.value===!0||W.value!==!0||t["no-option"]!==void 0))return _===!0?Rl():Al();u.hasPopupOpen===!0&&(u.hasPopupOpen=!1)},controlEvents:{onFocusin(l){u.onControlFocusin(l)},onFocusout(l){u.onControlFocusout(l,()=>{Oe(),Ee()})},onClick(l){if(et(l),_!==!0&&a.value===!0){Ee(),E.value!==null&&E.value.focus();return}Pe(l)}},getControl:l=>{const b=zl(),y=l===!0||i.value!==!0||_!==!0;if(e.useInput===!0)b.push(Ml(l,y));else if(u.editable.value===!0){const R=y===!0?at.value:void 0;b.push(F("input",{ref:y===!0?E:void 0,key:"d_t",class:"q-select__focus-target",id:y===!0?u.targetUid.value:void 0,value:K.value,readonly:!0,"data-autofocus":l===!0||e.autofocus===!0||void 0,...R,onKeydown:Bt,onKeyup:Ot,onKeypress:$t})),y===!0&&typeof e.autocomplete=="string"&&e.autocomplete.length!==0&&b.push(F("input",{class:"q-select__autocomplete-input",autocomplete:e.autocomplete,tabindex:-1,onKeyup:Rt}))}if(ue.value!==void 0&&e.disable!==!0&&rt.value.length!==0){const R=rt.value.map(O=>F("option",{value:O,selected:!0}));b.push(F("select",{class:"hidden",name:ue.value,multiple:e.multiple},R))}const V=e.useInput===!0||y!==!0?void 0:u.splitAttrs.attributes.value;return F("div",{class:"q-field__native row items-center",...V,...u.splitAttrs.listeners.value},b)},getInnerAppend:()=>e.loading!==!0&&c.value!==!0&&e.hideDropdownIcon!==!0?[F($e,{class:"q-select__dropdown-icon"+(a.value===!0?" rotate-180":""),name:je.value})]:null}),bl(u)}});let ct;const Gn=new Uint8Array(16);function Jn(){if(!ct&&(ct=typeof crypto!="undefined"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!ct))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return ct(Gn)}const Y=[];for(let e=0;e<256;++e)Y.push((e+256).toString(16).slice(1));function ea(e,t=0){return(Y[e[t+0]]+Y[e[t+1]]+Y[e[t+2]]+Y[e[t+3]]+"-"+Y[e[t+4]]+Y[e[t+5]]+"-"+Y[e[t+6]]+Y[e[t+7]]+"-"+Y[e[t+8]]+Y[e[t+9]]+"-"+Y[e[t+10]]+Y[e[t+11]]+Y[e[t+12]]+Y[e[t+13]]+Y[e[t+14]]+Y[e[t+15]]).toLowerCase()}const ta=typeof crypto!="undefined"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);var fl={randomUUID:ta};function la(e,t,n){if(fl.randomUUID&&!t&&!e)return fl.randomUUID();e=e||{};const o=e.random||(e.rng||Jn)();if(o[6]=o[6]&15|64,o[8]=o[8]&63|128,t){n=n||0;for(let s=0;s<16;++s)t[n+s]=o[s];return t}return ea(o)}const oa={setup(){const e=Qe(),t=Ho(),n=hl(),o=k(!1),s=k(null),a=k(null),{getAddLocation:i}=tt(e),d=k([]),m=k([]),p=k([]);return n.getCustomLocationsTypes.then(c=>{m.value=c.map(v=>({value:v.id,label:v.name}))}),n.getCustomLocationsStatuses.then(c=>{p.value=c.map(v=>({value:v.id,label:v.description}))}),{dialog:o,name:s,description:a,getAddLocation:i,locationStore:e,excursionStore:t,localCustomLocationStore:n,selectedType:k(null),typeOptions:m,selectedStatus:k(null),statusOptions:p,selectedExcursion:k(null),excursionOptions:d}},computed:{},methods:{async onSubmit(){var e;await this.localCustomLocationStore.add({id:-1,createdDate:No(),description:this.description,externalId:la(),isAuthor:!0,lat:this.getAddLocation[1],lng:this.getAddLocation[0],name:this.name,organizations:[],typeId:this.selectedType.value,statusId:this.selectedStatus.value,excursionId:(e=this.selectedExcursion)==null?void 0:e.value}),this.localCustomLocationStore.uploadNew().then(()=>{console.log("uploading customlocations finished")}),this.reset()},reset(){this.dialog=!1,this.name=null,this.description=null,this.selectedExcursion=null,this.selectedStatus=null,this.selectedType=null,this.filesImages=[],this.images=[]},filterFn(e,t,n){setTimeout(()=>{t(async()=>{this.excursionStore.addQueryParameter(e.toLowerCase()),await this.excursionStore.search(),this.excursionOptions=this.excursionStore.getExcursions.map(o=>({label:o.name,value:o.id})),this.excursionStore.addQueryParameter()},o=>{e!==""&&o.options.length>0&&(o.setOptionIndex(-1),o.moveOptionSelection(1,!0))})},300)},abortFilterFn(){console.log("delayed filter aborted")},inputValidator(e){return e&&e.length>0||this.$t("required")},dropDownValidator(e){return e||this.$t("required")}},watch:{getAddLocation(e,t){this.dialog=(e==null?void 0:e.length)>0}}},na={class:"q-gutter-md row items-center justify-end"};function aa(e,t,n,o,s,a){return B(),oe(lt,{modelValue:o.dialog,"onUpdate:modelValue":t[5]||(t[5]=i=>o.dialog=i),persistent:"","transition-show":"scale","transition-hide":"scale"},{default:h(()=>[r(ht,{class:"text-white q-pa-md",style:{width:"80%"}},{default:h(()=>[r(Cl,{onSubmit:a.onSubmit,onReset:a.reset,class:"q-gutter-md"},{default:h(()=>[r(Ft,{filled:"",modelValue:o.name,"onUpdate:modelValue":t[0]||(t[0]=i=>o.name=i),label:e.$t("customLocationName"),hint:e.$t("locationNameHint"),"lazy-rules":"",rules:[a.inputValidator]},null,8,["modelValue","label","hint","rules"]),r(Ft,{filled:"",modelValue:o.description,"onUpdate:modelValue":t[1]||(t[1]=i=>o.description=i),label:e.$t("customLocationDescription"),"lazy-rules":"",rules:[a.inputValidator]},null,8,["modelValue","label","rules"]),r(qt,{modelValue:o.selectedType,"onUpdate:modelValue":t[2]||(t[2]=i=>o.selectedType=i),options:o.typeOptions,label:e.$t("customLocationType"),"lazy-rules":"",rules:[a.dropDownValidator]},null,8,["modelValue","options","label","rules"]),r(qt,{modelValue:o.selectedStatus,"onUpdate:modelValue":t[3]||(t[3]=i=>o.selectedStatus=i),options:o.statusOptions,label:e.$t("customLocationStatus"),"lazy-rules":"",rules:[a.dropDownValidator]},null,8,["modelValue","options","label","rules"]),r(qt,{filled:"",modelValue:o.selectedExcursion,"onUpdate:modelValue":t[4]||(t[4]=i=>o.selectedExcursion=i),clearable:"","use-input":"","hide-selected":"","fill-input":"","input-debounce":"0",label:e.$t("excursion"),options:o.excursionOptions,onFilter:a.filterFn,onFilterAbort:a.abortFilterFn},{"no-option":h(()=>[r(Fe,null,{default:h(()=>[r(ae,{class:"text-grey"},{default:h(()=>[J(z(e.$t("noResults")),1)]),_:1})]),_:1})]),_:1},8,["modelValue","label","options","onFilter","onFilterAbort"]),ye("div",na,[r(me,{label:e.$t("submit"),type:"submit",color:"primary"},null,8,["label"]),r(me,{label:e.$t("cancel"),type:"reset",color:"primary",flat:"",class:"q-ml-sm"},null,8,["label"])])]),_:1},8,["onSubmit","onReset"])]),_:1})]),_:1},8,["modelValue"])}var ia=pe(oa,[["render",aa]]);const ra=Wo({name:"IndexPage",components:{PageFullScreen:en,CartoLayers:Ko,LocationLayers:vn,CustomLocationLayers:gn,DetailsDrawer:xn,OfflineConfirmDialog:zn,AddLocation:ia},setup(){const e=Qe(),t=gt(),n=pl(),o=k([1637531,5766419]),s=k("EPSG:3857"),a=k(8),i=k(!1),d=k([]),m=k(null),p=k(""),c=k("");return t.saveMapRef(c),{locationStore:e,center:o,projection:s,zoom:a,view:p,mapRef:c,markLocations:d,goTo:m,customLocations:i,mapStore:t,offlineStore:n}},data(){if(this.$route.query.lat&&this.$route.query.lng){const e=yl([this.$route.query.lng,this.$route.query.lat]),t=new Je(new dt(e));this.markLocations=[t],this.center=e,this.zoom=15,this.goTo=this.$route.query.navigate?t:null}return this.customLocations=this.$route.query.customLocation,{currentCenter:this.center,currentZoom:this.zoom,currentResolution:this.resolution,fixedCenter:!1}},computed:{trackLocationIcon(){return this.locationStore.getLocationTracking},navigationActive(){return this.locationStore.getNavigationActive},isCenterFixed(){return this.fixedCenter}},methods:{async onMapClick(e){if(e.coordinate){const t=this.mapRef.map.getFeaturesAtPixel(e.pixel);await this.mapStore.mapClick(e.coordinate,t)}},zoomChanged(e){this.currentZoom=e,this.mapStore.updateExtent(this.mapRef.map.getView().calculateExtent())},trackingClicked(e){this.locationStore.toggleLocationTracking()},myLocationClicked(e){this.center=this.locationStore.getMyLocationCoordinates,this.fixedCenter=!0,this.zoom=this.zoom<15?15:this.currentZoom},resolutionChanged(e){this.currentResolution=e.target.getResolution(),this.zoomChanged(e.target.getZoom())},centerChanged(e){if(!e.target)return;const t=e.target.getCenter();this.view!==""&&(this.currentCenter=t,this.view.getInteracting()?this.fixedCenter=!1:this.fixedCenter&&(this.center=t))},onScreenOrientationChange(){this.mapRef.updateSize()},storeDataForOffline(){this.offlineStore.showDialog()}},watch:{view(e,t){this.locationStore.initialize(e.getProjection()),this.goTo&&this.locationStore.startNavigation(this.goTo)}},mounted(){this.mapRef.map.on("click",async e=>{await this.onMapClick(e)})}});function ua(e,t,n,o,s,a){const i=D("ol-view"),d=D("CartoLayers"),m=D("LocationLayers"),p=D("CustomLocationLayers"),c=D("ol-source-vector"),v=D("ol-vector-layer"),w=D("ol-map"),f=D("DetailsDrawer"),_=D("OfflineConfirmDialog"),I=D("AddLocation"),x=D("PageFullScreen");return B(),oe(x,{style:{background:"#eee"}},{default:h(()=>[r(w,{loadTilesWhileAnimating:"",loadTilesWhileInteracting:"",style:{height:"100%"},moveTolerance:5,ref:"mapRef"},{default:h(()=>[r(i,{ref:"view",enableRotation:!1,center:e.center,zoom:e.zoom,projection:e.projection,"onChange:center":e.centerChanged,"onChange:resolution":e.resolutionChanged},null,8,["center","zoom","projection","onChange:center","onChange:resolution"]),r(d),r(m,{view:e.view,onCenterChanged:e.centerChanged},null,8,["view","onCenterChanged"]),e.customLocations?(B(),oe(p,{key:0})):Be("",!0),r(v,null,{default:h(()=>[r(c,{features:e.markLocations},null,8,["features"])]),_:1}),r(Wl,{onResize:e.onScreenOrientationChange},null,8,["onResize"])]),_:1},512),r(xt,{position:"top-right",offset:[18,18]},{default:h(()=>[r(Xt,{size:"100px","external-label":"",color:"purple",icon:"layers",direction:"left"},{default:h(()=>[(B(!0),ve(ot,null,gl(e.mapStore.getLayers,$=>(B(),oe(kt,{key:$.name,padding:"3px","label-class":"bg-grey-3 text-grey-8","external-label":"","label-position":"bottom",color:$.active?"red":"primary",onClick:te=>$.active=!$.active,icon:`img:${$.preview}`,label:$.label},null,8,["color","onClick","icon","label"]))),128))]),_:1})]),_:1}),r(xt,{position:"bottom-left",offset:[18,18]},{default:h(()=>[r(me,{fab:"",icon:e.isCenterFixed?"my_location":"location_searching",color:"accent",onClick:e.myLocationClicked},null,8,["icon","onClick"])]),_:1}),r(xt,{position:"bottom-right",offset:[18,18]},{default:h(()=>[r(Xt,{size:"100px","vertical-actions-align":"right",glossy:"",color:"purple",icon:"add",direction:"up"},{default:h(()=>[r(kt,{disable:e.currentZoom<14,"label-position":"right",color:"primary",onClick:e.storeDataForOffline,icon:"wifi_off",label:"Offline"},null,8,["disable","onClick"]),r(kt,{"label-position":"right",color:"secondary",icon:e.trackLocationIcon?"stop_circle":"play_arrow",label:"Start track",onClick:e.trackingClicked},null,8,["icon","onClick"])]),_:1})]),_:1}),r(f),r(_),r(I)]),_:1})}var ya=pe(ra,[["render",ua]]);export{ya as default};
